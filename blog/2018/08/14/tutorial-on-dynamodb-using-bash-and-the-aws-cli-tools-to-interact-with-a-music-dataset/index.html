
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Tutorial on DynamoDB Using Bash and the AWS CLI Tools to Interact With a Music Dataset - Ruan Bekker's Blog</title>
  <meta name="author" content="Ruan">

  
  <meta name="description" content="In this tutorial we will be using Amazons DynamoDB (DynamoDB Local) to host a sample dataset consisting of music data that I retrieved from the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <!-- font awesome --!>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="canonical" href="http://blog.ruanbekker.com/blog/2018/08/14/tutorial-on-dynamodb-using-bash-and-the-aws-cli-tools-to-interact-with-a-music-dataset/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Ruan Bekker's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-105336110-1']);
    _gaq.push(['_setDomainName','ruanbekker.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ruan Bekker's Blog</a></h1>
  
    <h2>From a Curious mind to Posts on Github</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://blog.ruanbekker.com/search/" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="blog.ruanbekker.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories/aws/">AWS</a></li>
  <li><a href="/blog/categories/docker/">Docker</a></li>
  <li><a href="/blog/categories/devops/">DevOps</a></li>
  <li><a href="/blog/categories/python/">Python</a></li>
  <li><a target="_blank" href="https://sysadmins.co.za">My HowTo Blog</a></li>
  <li><a href="/awesome-links/">Awesome Links</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Tutorial on DynamoDB Using Bash and the AWS CLI Tools to Interact With a Music Dataset</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2018-08-14T16:33:22-04:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>4:33 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p><img src="https://objects.ruanbekker.com/assets/images/aws-logo.png" alt="" /></p>

<p>In this tutorial we will be using Amazons DynamoDB (DynamoDB Local) to host a sample dataset consisting of music data that I retrieved from the iTunes API, which we will be using the aws cli tools to interact with the data.</p>

<p>We will be doing the following:</p>

<ul>
<li>Use Docker to provision a Local DynamoDB Server</li>
<li>Create a DynamoDB Table with a Hash and Range Key</li>
<li>List the Table</li>
<li>Create a Item in DynamoDB</li>
<li>Read a Item from DynamoDB</li>
<li>Read a Item from DynamoDB by specifying the details you would like to read</li>
<li>Batch Write multiple items to DynamoDB</li>
<li>Scan all your Items from DynamoDB</li>
<li>Query by Artist</li>
<li>Query by Artist and Song</li>
<li>Query all the Songs from an Artist starting with a specific letter</li>
<li>Indexes</li>
<li>Delete the Table</li>
</ul>


<p>If you are just getting started with DynamoDB, I recommend having a look at <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Introduction.html">Amazons DynamoDB Documentation</a> Page first.</p>

<script id="mNCC" language="javascript">
    medianet_width = "728";
    medianet_height = "90";
    medianet_crid = "218284798";
    medianet_versionId = "3111299"; 
  </script>


<script src="//contextual.media.net/nmedianet.js?cid=8CUD78FSV"></script>


<h2>The Music Dataset:</h2>

<p>I used the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes API</a> to get the music metadata, but I also have a post on <a href="http://blog.ruanbekker.com/blog/2018/05/08/use-python-requests-to-interact-with-the-itunes-api-to-search-for-music-info/">how to query the iTunes API</a> to get data from them to use.</p>

<p>a Quick way in Python to get the top 10 songs from Guns and Roses, will look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="s">&#39;https://itunes.apple.com/search?term=guns+and+roses&amp;limit=10&#39;</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Create the DynamoDB Local Server on Docker:</h2>

<p>If you have a AWS Account you can provision your table from there, but if you want to test it locally, you can provision a local DynamoDB Server using Docker:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="err">$</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8000</span><span class="p">:</span><span class="mi">8000</span> <span class="o">--</span><span class="n">name</span> <span class="n">dynamodb</span><span class="o">-</span><span class="n">local</span> <span class="n">rbekker87</span><span class="o">/</span><span class="n">dynamodb</span><span class="o">-</span><span class="n">local</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Install the AWS CLI Tools:</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>pip install awscli
</span><span class='line'><span class="nv">$ </span>aws configure
</span><span class='line'><span class="c"># you can enter random data if you are using dynamodb-local</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Create the DynamoDB Table:</h2>

<p>Create a DynamoDB Table named <code>MusicCollection</code> with a <code>Artist (HASH)</code> and <code>SongTitle (RANGE)</code> key attributes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb create-table --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --attribute-definitions <span class="nv">AttributeName</span><span class="o">=</span>Artist,AttributeType<span class="o">=</span>S <span class="nv">AttributeName</span><span class="o">=</span>SongTitle,AttributeType<span class="o">=</span>S <span class="se">\</span>
</span><span class='line'>  --key-schema <span class="nv">AttributeName</span><span class="o">=</span>Artist,KeyType<span class="o">=</span>HASH <span class="nv">AttributeName</span><span class="o">=</span>SongTitle,KeyType<span class="o">=</span>RANGE <span class="se">\</span>
</span><span class='line'>  --provisioned-throughput <span class="nv">ReadCapacityUnits</span><span class="o">=</span>5,WriteCapacityUnits<span class="o">=</span><span class="m">5</span> <span class="se">\</span>
</span><span class='line'>  --endpoint-url http://localhost:8000
</span><span class='line'>
</span><span class='line'>Response:
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;TableDescription&quot;</span>: <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;TableArn&quot;</span>: <span class="s2">&quot;arn:aws:dynamodb:ddblocal:000000000000:table/MusicCollection&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;AttributeDefinitions&quot;</span>: <span class="o">[</span>
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;Artist&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeType&quot;</span>: <span class="s2">&quot;S&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;SongTitle&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeType&quot;</span>: <span class="s2">&quot;S&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">]</span>,
</span><span class='line'>        <span class="s2">&quot;ProvisionedThroughput&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;NumberOfDecreasesToday&quot;</span>: 0,
</span><span class='line'>            <span class="s2">&quot;WriteCapacityUnits&quot;</span>: 5,
</span><span class='line'>            <span class="s2">&quot;LastIncreaseDateTime&quot;</span>: 0.0,
</span><span class='line'>            <span class="s2">&quot;ReadCapacityUnits&quot;</span>: 5,
</span><span class='line'>            <span class="s2">&quot;LastDecreaseDateTime&quot;</span>: 0.0
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="s2">&quot;TableSizeBytes&quot;</span>: 0,
</span><span class='line'>        <span class="s2">&quot;TableName&quot;</span>: <span class="s2">&quot;MusicCollection&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;TableStatus&quot;</span>: <span class="s2">&quot;ACTIVE&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;KeySchema&quot;</span>: <span class="o">[</span>
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;KeyType&quot;</span>: <span class="s2">&quot;HASH&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;Artist&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;KeyType&quot;</span>: <span class="s2">&quot;RANGE&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;SongTitle&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">]</span>,
</span><span class='line'>        <span class="s2">&quot;ItemCount&quot;</span>: 0,
</span><span class='line'>        <span class="s2">&quot;CreationDateTime&quot;</span>: 1525339294.186
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Listing the Tables:</h2>

<p>List the DynamoDB Table that you created:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb list-tables --endpoint-url http://localhost:8000
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;TableNames&quot;</span>: <span class="o">[</span>
</span><span class='line'>        <span class="s2">&quot;MusicCollection&quot;</span>
</span><span class='line'>    <span class="o">]</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Create a Item in DynamoDB:</h2>

<p>Add a song from the band <code>Bring me the Horizon</code> called <code>Sleepwalking</code> from the album <code>Sempiternal</code> to the table by using the <code>PutItem</code> call:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 put-item --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --item <span class="s1">&#39;{&quot;Artist&quot;: {&quot;S&quot;: &quot;Bring me the Horizon&quot;}, &quot;SongTitle&quot;: {&quot;S&quot;: &quot;Sleepwalking&quot;}, &quot;AlbumTitle&quot;: {&quot;S&quot;: &quot;Sempiternal&quot;}}&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Read a Item from DynamoDB</h2>

<p>Get the Song Details from the Table by using the <code>GetItem</code> call:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 get-item --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --key  <span class="s1">&#39;{&quot;Artist&quot;: {&quot;S&quot;: &quot;Bring me the Horizon&quot;}, &quot;SongTitle&quot;: {&quot;S&quot;: &quot;Sleepwalking&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Item&quot;</span>: <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Bring me the Horizon&quot;</span>
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Sleepwalking&quot;</span>
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Sempiternal&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To only get specific attributes we can use <code>--aatributes-to-get</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 get-item --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --attributes-to-get <span class="s1">&#39;[&quot;AlbumTitle&quot;, &quot;SongTitle&quot;]&#39;</span> <span class="se">\</span>
</span><span class='line'>  --key  <span class="s1">&#39;{&quot;Artist&quot;: {&quot;S&quot;: &quot;Bring me the Horizon&quot;}, &quot;SongTitle&quot;: {&quot;S&quot;: &quot;Sleepwalking&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Item&quot;</span>: <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Sleepwalking&quot;</span>
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Sempiternal&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>However, AWS Recommends to use the <code>--projection-expression</code> parameter:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 get-item --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --projection-expression <span class="s2">&quot;AlbumTitle, SongTitle&quot;</span> <span class="se">\</span>
</span><span class='line'>  --key  <span class="s1">&#39;{&quot;Artist&quot;: {&quot;S&quot;: &quot;Bring me the Horizon&quot;}, &quot;SongTitle&quot;: {&quot;S&quot;: &quot;Sleepwalking&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Item&quot;</span>: <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Sleepwalking&quot;</span>
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Sempiternal&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LegacyConditionalParameters.AttributesToGet.html">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LegacyConditionalParameters.AttributesToGet.html</a></li>
</ul>


<h2>Batch Write</h2>

<p>Now lets use the <a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">iTunes API</a> to get a collection of some songs, which I will dump into a <a href="https://github.com/ruanbekker/dynamodb-local-docker/blob/master/demo/batch-write-songs.json">json file on github</a>. So now that we have a json file with a collection of songs from multiple artists, we can go ahead and write it into our table using the <code>BatchWriteItem</code> call:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>wget https://raw.githubusercontent.com/ruanbekker/dynamodb-local-docker/master/demo/batch-write-songs.json
</span><span class='line'><span class="nv">$ </span>aws dynamodb batch-write-item --request-items file://music-table/batch-write-songs.json --endpoint-url http://localhost:8000
</span></code></pre></td></tr></table></div></figure>


<h2>Scan the Table:</h2>

<p>This can be a very expensive call, as a <code>Scan</code> will return all the items from your table, and depending on the size of your table, you could be throttled, but since we are using dynamodb local and only having 16 items in our table, we can do a scan to return all the items in our table:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 scan --table-name MusicCollection
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Count&quot;</span>: 16,
</span></code></pre></td></tr></table></div></figure>


<h2>Query</h2>

<p>Let&rsquo;s start using the <code>Query</code> call to get all the songs from the Artist: AC/DC</p>

<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LegacyConditionalParameters.QueryFilter.html">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LegacyConditionalParameters.QueryFilter.html</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 query --select ALL_ATTRIBUTES <span class="se">\</span>
</span><span class='line'>  --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --key-condition-expression <span class="s2">&quot;Artist = :a&quot;</span> <span class="se">\</span>
</span><span class='line'>  --expression-attribute-values  <span class="s1">&#39;{&quot;:a&quot;:{&quot;S&quot;:&quot;AC/DC&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Count&quot;</span>: 3,
</span><span class='line'>    <span class="s2">&quot;Items&quot;</span>: <span class="o">[</span>
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;AC/DC&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Back In Black&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Back In Black&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;AC/DC&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Thunderstruck&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;The Razors Edge&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;AC/DC&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;You Shook Me All Night Long&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Back in Black&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">]</span>,
</span><span class='line'>    <span class="s2">&quot;ScannedCount&quot;</span>: 3,
</span><span class='line'>    <span class="s2">&quot;ConsumedCapacity&quot;</span>: null
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Query to get the details of a specific Song from a specific Artist:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 query --select ALL_ATTRIBUTES <span class="se">\</span>
</span><span class='line'>  --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --key-condition-expression <span class="s2">&quot;Artist = :a and SongTitle = :t&quot;</span> <span class="se">\</span>
</span><span class='line'>  --expression-attribute-values  <span class="s1">&#39;{ &quot;:a&quot;: {&quot;S&quot;: &quot;AC/DC&quot;}, &quot;:t&quot;: {&quot;S&quot;: &quot;You Shook Me All Night Long&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Count&quot;</span>: 1,
</span><span class='line'>    <span class="s2">&quot;Items&quot;</span>: <span class="o">[</span>
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;AC/DC&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;You Shook Me All Night Long&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Back in Black&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">]</span>,
</span><span class='line'>    <span class="s2">&quot;ScannedCount&quot;</span>: 1,
</span><span class='line'>    <span class="s2">&quot;ConsumedCapacity&quot;</span>: null
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Query to get all the songs from the Beatles that starts with the letter &lsquo;H&rsquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 query --select ALL_ATTRIBUTES <span class="se">\</span>
</span><span class='line'>  --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --key-condition-expression <span class="s2">&quot;Artist = :a and begins_with(SongTitle, :t)&quot;</span> <span class="se">\</span>
</span><span class='line'>  --expression-attribute-values  <span class="s1">&#39;{&quot;:a&quot;:{&quot;S&quot;:&quot;The Beatles&quot;}, &quot;:t&quot;: {&quot;S&quot;: &quot;h&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Count&quot;</span>: 2,
</span><span class='line'>    <span class="s2">&quot;Items&quot;</span>: <span class="o">[</span>
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;The Beatles&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Happy Day&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;The Beatles 1967-1970 (The Blue Album)&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;The Beatles&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Help!&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;The Beatles Box Set&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">]</span>,
</span><span class='line'>    <span class="s2">&quot;ScannedCount&quot;</span>: 2,
</span><span class='line'>    <span class="s2">&quot;ConsumedCapacity&quot;</span>: null
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So our table consists of Artist (HASH) and SongTitle (RANGE), so we can only query based on those attributes. You will find when you try to query on a attribute that is not part of the KeySchema, a exception will be received:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 query --select ALL_ATTRIBUTES --table-name MusicCollection --key-condition-expression <span class="s2">&quot;Artist = :a and AlbumTitle = :t&quot;</span> --expression-attribute-values  <span class="s1">&#39;{&quot;:a&quot;:{&quot;S&quot;:&quot;AC/DC&quot;}, &quot;:t&quot;: {&quot;S&quot;: &quot;Back in Black&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'>An error occurred <span class="o">(</span>ValidationException<span class="o">)</span> when calling the Query operation: Query condition missed key schema element
</span></code></pre></td></tr></table></div></figure>


<p>So how do we query on a attribute that is not part of the KeySchema? Let&rsquo;s say you want to query all the songs from a Artist and a specific Album.</p>

<h2>Global Secondary Indexes:</h2>

<p>Add Global Secondary Index, with the Attributes: Artist and AlbumTitle.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 update-table --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --attribute-definitions <span class="nv">AttributeName</span><span class="o">=</span>Artist,AttributeType<span class="o">=</span>S <span class="nv">AttributeName</span><span class="o">=</span>SongTitle,AttributeType<span class="o">=</span>S <span class="nv">AttributeName</span><span class="o">=</span>AlbumTitle,AttributeType<span class="o">=</span>S <span class="se">\</span>
</span><span class='line'>  --global-secondary-index-updates <span class="s2">&quot;Create={&quot;</span>IndexName<span class="s2">&quot;=&quot;</span>album-index<span class="s2">&quot;, &quot;</span>KeySchema<span class="s2">&quot;=[ {&quot;</span>AttributeName<span class="s2">&quot;=&quot;</span>Artist<span class="s2">&quot;, &quot;</span>KeyType<span class="s2">&quot;=&quot;</span>HASH<span class="s2">&quot;}, {&quot;</span>AttributeName<span class="s2">&quot;=&quot;</span>AlbumTitle<span class="s2">&quot;, &quot;</span>KeyType<span class="s2">&quot;=&quot;</span>RANGE<span class="s2">&quot; }], &quot;</span>Projection<span class="s2">&quot;={&quot;</span>ProjectionType<span class="s2">&quot;=&quot;</span>INCLUDE<span class="s2">&quot;, &quot;</span>NonKeyAttributes<span class="s2">&quot;=&quot;</span>AlbumTitle<span class="s2">&quot;}, &quot;</span>ProvisionedThroughput<span class="s2">&quot;= {&quot;</span>ReadCapacityUnits<span class="s2">&quot;=1, &quot;</span>WriteCapacityUnits<span class="s2">&quot;=1} }&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;TableDescription&quot;</span>: <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;TableArn&quot;</span>: <span class="s2">&quot;arn:aws:dynamodb:ddblocal:000000000000:table/MusicCollection&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;AttributeDefinitions&quot;</span>: <span class="o">[</span>
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;Artist&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeType&quot;</span>: <span class="s2">&quot;S&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;SongTitle&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeType&quot;</span>: <span class="s2">&quot;S&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;AlbumTitle&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeType&quot;</span>: <span class="s2">&quot;S&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">]</span>,
</span><span class='line'>        <span class="s2">&quot;GlobalSecondaryIndexes&quot;</span>: <span class="o">[</span>
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;IndexName&quot;</span>: <span class="s2">&quot;album-index&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;Projection&quot;</span>: <span class="o">{</span>
</span><span class='line'>                    <span class="s2">&quot;ProjectionType&quot;</span>: <span class="s2">&quot;INCLUDE&quot;</span>,
</span><span class='line'>                    <span class="s2">&quot;NonKeyAttributes&quot;</span>: <span class="o">[</span>
</span><span class='line'>                        <span class="s2">&quot;AlbumTitle&quot;</span>
</span><span class='line'>                    <span class="o">]</span>
</span><span class='line'>                <span class="o">}</span>,
</span><span class='line'>                <span class="s2">&quot;ProvisionedThroughput&quot;</span>: <span class="o">{</span>
</span><span class='line'>                    <span class="s2">&quot;WriteCapacityUnits&quot;</span>: 1,
</span><span class='line'>                    <span class="s2">&quot;ReadCapacityUnits&quot;</span>: 1
</span><span class='line'>                <span class="o">}</span>,
</span><span class='line'>                <span class="s2">&quot;IndexStatus&quot;</span>: <span class="s2">&quot;CREATING&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;Backfilling&quot;</span>: <span class="nb">false</span>,
</span><span class='line'>                <span class="s2">&quot;KeySchema&quot;</span>: <span class="o">[</span>
</span><span class='line'>                    <span class="o">{</span>
</span><span class='line'>                        <span class="s2">&quot;KeyType&quot;</span>: <span class="s2">&quot;HASH&quot;</span>,
</span><span class='line'>                        <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;Artist&quot;</span>
</span><span class='line'>                    <span class="o">}</span>,
</span><span class='line'>                    <span class="o">{</span>
</span><span class='line'>                        <span class="s2">&quot;KeyType&quot;</span>: <span class="s2">&quot;RANGE&quot;</span>,
</span><span class='line'>                        <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;AlbumTitle&quot;</span>
</span><span class='line'>                    <span class="o">}</span>
</span><span class='line'>                <span class="o">]</span>,
</span><span class='line'>                <span class="s2">&quot;IndexArn&quot;</span>: <span class="s2">&quot;arn:aws:dynamodb:ddblocal:000000000000:table/MusicCollection/index/album-index&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">]</span>,
</span><span class='line'>        <span class="s2">&quot;ProvisionedThroughput&quot;</span>: <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;NumberOfDecreasesToday&quot;</span>: 0,
</span><span class='line'>            <span class="s2">&quot;WriteCapacityUnits&quot;</span>: 5,
</span><span class='line'>            <span class="s2">&quot;LastIncreaseDateTime&quot;</span>: 0.0,
</span><span class='line'>            <span class="s2">&quot;ReadCapacityUnits&quot;</span>: 5,
</span><span class='line'>            <span class="s2">&quot;LastDecreaseDateTime&quot;</span>: 0.0
</span><span class='line'>        <span class="o">}</span>,
</span><span class='line'>        <span class="s2">&quot;TableSizeBytes&quot;</span>: 984,
</span><span class='line'>        <span class="s2">&quot;TableName&quot;</span>: <span class="s2">&quot;MusicCollection&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;TableStatus&quot;</span>: <span class="s2">&quot;ACTIVE&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;KeySchema&quot;</span>: <span class="o">[</span>
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;KeyType&quot;</span>: <span class="s2">&quot;HASH&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;Artist&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;KeyType&quot;</span>: <span class="s2">&quot;RANGE&quot;</span>,
</span><span class='line'>                <span class="s2">&quot;AttributeName&quot;</span>: <span class="s2">&quot;SongTitle&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">]</span>,
</span><span class='line'>        <span class="s2">&quot;ItemCount&quot;</span>: 15,
</span><span class='line'>        <span class="s2">&quot;CreationDateTime&quot;</span>: 1525339294.186
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now when we use the same query, but we specify our index, we will get the data:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 query <span class="se">\</span>
</span><span class='line'>  --select ALL_ATTRIBUTES <span class="se">\</span>
</span><span class='line'>  --table-name MusicCollection <span class="se">\</span>
</span><span class='line'>  --index-name album-index <span class="se">\</span>
</span><span class='line'>  --key-condition-expression <span class="s2">&quot;Artist = :a and AlbumTitle = :t&quot;</span> <span class="se">\</span>
</span><span class='line'>  --expression-attribute-values  <span class="s1">&#39;{&quot;:a&quot;:{&quot;S&quot;:&quot;AC/DC&quot;}, &quot;:t&quot;: {&quot;S&quot;: &quot;Back in Black&quot;}}&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="s2">&quot;Count&quot;</span>: 1,
</span><span class='line'>    <span class="s2">&quot;Items&quot;</span>: <span class="o">[</span>
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;Artist&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;AC/DC&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;SongTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;You Shook Me All Night Long&quot;</span>
</span><span class='line'>            <span class="o">}</span>,
</span><span class='line'>            <span class="s2">&quot;AlbumTitle&quot;</span>: <span class="o">{</span>
</span><span class='line'>                <span class="s2">&quot;S&quot;</span>: <span class="s2">&quot;Back in Black&quot;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">]</span>,
</span><span class='line'>    <span class="s2">&quot;ScannedCount&quot;</span>: 1,
</span><span class='line'>    <span class="s2">&quot;ConsumedCapacity&quot;</span>: null
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Delete the Table:</h2>

<p>Delete the Table that we created:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws dynamodb --endpoint-url http://localhost:8000 delete-table --table-name MusicCollection
</span></code></pre></td></tr></table></div></figure>


<h2>Resources:</h2>

<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SQLtoNoSQL.ReadData.Query.html">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SQLtoNoSQL.ReadData.Query.html</a></li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SQLtoNoSQL.Indexes.html">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SQLtoNoSQL.Indexes.html</a></li>
<li><a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/">https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/</a></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ruan</span></span>

      




<time class='entry-date' datetime='2018-08-14T16:33:22-04:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>4:33 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/aws/'>aws</a>, <a class='category' href='/blog/categories/awscli/'>awscli</a>, <a class='category' href='/blog/categories/bash/'>bash</a>, <a class='category' href='/blog/categories/docker/'>docker</a>, <a class='category' href='/blog/categories/dynamodb/'>dynamodb</a>, <a class='category' href='/blog/categories/nosql/'>nosql</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://blog.ruanbekker.com/blog/2018/08/14/tutorial-on-dynamodb-using-bash-and-the-aws-cli-tools-to-interact-with-a-music-dataset/" data-via="ruanbekker" data-counturl="http://blog.ruanbekker.com/blog/2018/08/14/tutorial-on-dynamodb-using-bash-and-the-aws-cli-tools-to-interact-with-a-music-dataset/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2018/08/09/ruby-tutorial-series-setup-and-variables/" title="Previous Post: Ruby Tutorial Series Setup and Variables">&laquo; Ruby Tutorial Series Setup and Variables</a>
      
      
        <a class="basic-alignment right" href="/blog/2018/08/15/get-blogpost-titles-links-and-tags-from-a-rss-link-using-python-feedparser/" title="Next Post: Get Blogpost Titles Links and Tags from a RSS Link using Python Feedparser">Get Blogpost Titles Links and Tags from a RSS Link using Python Feedparser &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/11/23/setup-a-relayhost-with-postfix-to-send-mail-via-sendgrid/">Setup a Relayhost With Postfix to Send Mail via Sendgrid</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/22/setup-a-golang-environment-on-ubuntu/">Setup a Golang Environment on Ubuntu</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/21/golang-building-a-basic-web-server-in-go/">Golang: Building a Basic Web Server in Go</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/12/create-read-only-users-in-mongodb/">Create Read Only Users in MongoDB</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/12/iam-policy-to-allow-team-wide-and-user-level-permissions-on-aws-secrets-manager/">IAM Policy to Allow Team Wide and User Level Permissions on AWS Secrets Manager</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Ruan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>



  <li>
    <a href="https://twitter.com/ruanbekker">
      <i class="fa fa-twitter"></i> Twitter
    </a>
  </li>



  <li>
    <a href="https://github.com/ruanbekker">
      <i class="fa fa-github"></i> GitHub
    </a>
  </li>



  <li>
    <a href="https://sysadmins.co.za">
      <i class="fa fa-bars"></i> My HowTo Blog
    </a>
  </li>


</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'blog-ruanbekker';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.ruanbekker.com/blog/2018/08/14/tutorial-on-dynamodb-using-bash-and-the-aws-cli-tools-to-interact-with-a-music-dataset/';
        var disqus_url = 'http://blog.ruanbekker.com/blog/2018/08/14/tutorial-on-dynamodb-using-bash-and-the-aws-cli-tools-to-interact-with-a-music-dataset/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
