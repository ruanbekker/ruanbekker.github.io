
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Run Docker Containers With Terraform - Ruan Bekker's Blog</title>
  <meta name="author" content="Ruan">

  
  <meta name="description" content="In this post I will demonstrate how to use the terraform docker_container resource from the docker provider to run two docker containers, traefik and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- font awesome --!>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <!-- samwize.com/2012/09/24/octopress-table-stylesheet --!>
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />

  
  <link rel="canonical" href="https://blog.ruanbekker.com/blog/2021/11/23/run-docker-containers-with-terraform/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Ruan Bekker's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-105336110-1']);
    _gaq.push(['_setDomainName','ruanbekker.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
<script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, '//fh-blog-ruanbekker-com.home.ruan.dev/tracker.js', 'fathom');
fathom('set', 'siteId', 'MWBHH');
fathom('trackPageview');
</script>
<!-- / Fathom -->

  <!-- Twitter cards # www.brianbunke.com/blog/2017/09/06/twitter-cards-on-jekyll -->
<meta name="twitter:site"    content="@ruanbekker">
<meta name="twitter:creator" content="@">
<meta name="twitter:title"   content="Run Docker Containers with Terraform">


<meta name="twitter:description" content="">



<meta name="twitter:card"  content="summary">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/567298/69000657-c093e780-08db-11ea-8464-bcd3023e9923.png">

<!-- end of Twitter cards -->

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ruan Bekker's Blog</a></h1>
  
    <h2>From a Curious mind to Posts on Github</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://blog.ruanbekker.com/search/" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="blog.ruanbekker.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories/aws/">AWS</a></li>
  <li><a href="/blog/categories/docker/">Docker</a></li>
  <li><a href="/blog/categories/devops/">DevOps</a></li>
  <li><a href="/blog/categories/python/">Python</a></li>
  <li><a target="_blank" href="https://sysadmins.co.za">My Sysadmins Blog</a></li>
  <li><a href="https://ruan.dev/">About Me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Run Docker Containers With Terraform</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2021-11-23T11:06:03-05:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2021</span></span> <span class='time'>11:06 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>In this post I will demonstrate how to use the terraform <a href="https://registry.terraform.io/providers/kreuzwerker/docker/latest/docs/resources/container">docker_container</a> resource from the <a href="https://github.com/kreuzwerker/terraform-provider-docker">docker provider</a> to run two docker containers, traefik and nginx and use the random provider to generate a random url for us.</p>

<h2>Pre-Requisites</h2>

<p>You will require <a href="https://www.terraform.io/downloads.html">terraform</a> and <a href="https://docs.docker.com/get-docker/">docker</a> to be installed.</p>

<h2>Project Structure</h2>

<p>The source code for this post is available on my github repository, but the project structure will look like the following:</p>

<p><img src="https://user-images.githubusercontent.com/567298/143061769-c619e7eb-c5b1-42bc-9fa4-ed59c15448fa.png" alt="image" /></p>

<p>Our <code>providers.tf</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>terraform {
</span><span class='line'>  required_providers {
</span><span class='line'>    docker = {
</span><span class='line'>      source  = "kreuzwerker/docker"
</span><span class='line'>      version = "2.15.0"
</span><span class='line'>    }
</span><span class='line'>    random = {
</span><span class='line'>      version = "~&gt; 3.0"
</span><span class='line'>    }
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>provider "docker" {
</span><span class='line'>  host = "unix:///var/run/docker.sock"
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>provider "random" {}</span></code></pre></td></tr></table></div></figure>


<p>Our <code>variables.tf</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>variable "domain" {
</span><span class='line'>  type    = string
</span><span class='line'>  default = "localdns.xyz"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Our <code>outputs.tf</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>output "nginx_container_name" {
</span><span class='line'>  value = docker_container.nginx.name
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>output "traefik_container_name" {
</span><span class='line'>  value = docker_container.traefik.name
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>output "traefik_url" {
</span><span class='line'>  value = "http://traefik.${var.domain}/"
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>output "nginx_url" {
</span><span class='line'>  value = "http://www.${random_string.nginx.result}.${var.domain}/"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Our <code>main.tf</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>resource "random_string" "nginx" {
</span><span class='line'>  length  = 8
</span><span class='line'>  upper   = false
</span><span class='line'>  special = false
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>resource "docker_image" "nginx" {
</span><span class='line'>  name = "nginx:stable-alpine"
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>resource "docker_image" "traefik" {
</span><span class='line'>  name = "traefik:1.7.14"
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>resource "docker_network" "nginx" {
</span><span class='line'>  name   = "docknet"
</span><span class='line'>  driver = "bridge"
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>resource "docker_container" "traefik" {
</span><span class='line'>  name  = "traefik"
</span><span class='line'>  image = docker_image.traefik.name
</span><span class='line'>
</span><span class='line'>  networks_advanced {
</span><span class='line'>    name    = docker_network.nginx.name
</span><span class='line'>    aliases = ["docknet"]
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  restart = "unless-stopped"
</span><span class='line'>  destroy_grace_seconds = 30
</span><span class='line'>  must_run = true
</span><span class='line'>  memory = 256
</span><span class='line'>
</span><span class='line'>  volumes {
</span><span class='line'>    host_path      = "/var/run/docker.sock"
</span><span class='line'>    container_path = "/var/run/docker.sock"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  command = [
</span><span class='line'>    "--api",
</span><span class='line'>    "--docker",
</span><span class='line'>    "--docker.watch",
</span><span class='line'>    "--entrypoints=Name:http Address::80",
</span><span class='line'>    "--logLevel=INFO"
</span><span class='line'>  ]
</span><span class='line'>
</span><span class='line'>  ports {
</span><span class='line'>    internal = 80
</span><span class='line'>    external = 80
</span><span class='line'>    ip       = "0.0.0.0"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.enable"
</span><span class='line'>    value = true
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.docker.network"
</span><span class='line'>    value = "docknet"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.frontend.rule"
</span><span class='line'>    value = "Host:traefik.${var.domain}"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.port"
</span><span class='line'>    value = 8080
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>resource "docker_container" "nginx" {
</span><span class='line'>  name  = "nginx"
</span><span class='line'>  image = docker_image.nginx.name
</span><span class='line'>
</span><span class='line'>  networks_advanced {
</span><span class='line'>    name    = docker_network.nginx.name
</span><span class='line'>    aliases = ["docknet"]
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  restart = "unless-stopped"
</span><span class='line'>  destroy_grace_seconds = 30
</span><span class='line'>  must_run = true
</span><span class='line'>  memory = 256
</span><span class='line'>
</span><span class='line'>  volumes {
</span><span class='line'>    host_path      = "/Users/ruan/personal/terraform-playground/docker-containers/html"
</span><span class='line'>    container_path = "/usr/share/nginx/html"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  volumes {
</span><span class='line'>    host_path      = "/Users/ruan/personal/terraform-playground/docker-containers/configs/nginx.conf"
</span><span class='line'>    container_path = "/etc/nginx/nginx.conf"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  volumes {
</span><span class='line'>    host_path      = "/Users/ruan/personal/terraform-playground/docker-containers/configs/app.conf"
</span><span class='line'>    container_path = "/etc/nginx/conf.d/app.conf"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  env = [
</span><span class='line'>    "PUID=501",
</span><span class='line'>    "PGID=20"
</span><span class='line'>  ]
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.enable"
</span><span class='line'>    value = true
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.docker.network"
</span><span class='line'>    value = "docknet"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.frontend.rule"
</span><span class='line'>    value = "Host:www.${random_string.nginx.result}.${var.domain}"
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  labels {
</span><span class='line'>    label = "traefik.port"
</span><span class='line'>    value = 80
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  depends_on = [
</span><span class='line'>    docker_container.traefik,
</span><span class='line'>    random_string.nginx
</span><span class='line'>  ]
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Our <code>html/index.html</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!doctype html&gt;</span>
</span><span class='line'><span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;head&gt;</span>
</span><span class='line'>        <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content=</span><span class="s">&quot;width=device-width, initial-scale=1&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nt">&lt;title&gt;</span>Welcome<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c">&lt;!-- Fonts --&gt;</span>
</span><span class='line'>        <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;https://fonts.googleapis.com/css?family=Nunito:200,600&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c">&lt;!-- Styles --&gt;</span>
</span><span class='line'>        <span class="nt">&lt;style&gt;</span>
</span><span class='line'>            <span class="nt">html</span><span class="o">,</span> <span class="nt">body</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">background-color</span><span class="o">:</span> <span class="m">#fff</span><span class="p">;</span>
</span><span class='line'>                <span class="k">color</span><span class="o">:</span> <span class="m">#636b6f</span><span class="p">;</span>
</span><span class='line'>                <span class="k">font-family</span><span class="o">:</span> <span class="s1">&#39;Nunito&#39;</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
</span><span class='line'>                <span class="k">font-weight</span><span class="o">:</span> <span class="m">200</span><span class="p">;</span>
</span><span class='line'>                <span class="k">height</span><span class="o">:</span> <span class="m">100</span><span class="n">vh</span><span class="p">;</span>
</span><span class='line'>                <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.full-height</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">height</span><span class="o">:</span> <span class="m">100</span><span class="n">vh</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.flex-center</span> <span class="p">{</span>
</span><span class='line'>                <span class="n">align</span><span class="o">-</span><span class="n">items</span><span class="o">:</span> <span class="k">center</span><span class="p">;</span>
</span><span class='line'>                <span class="k">display</span><span class="o">:</span> <span class="n">flex</span><span class="p">;</span>
</span><span class='line'>                <span class="k">justify</span><span class="o">-</span><span class="k">content</span><span class="o">:</span> <span class="k">center</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.position-ref</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">position</span><span class="o">:</span> <span class="k">relative</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.top-right</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">position</span><span class="o">:</span> <span class="k">absolute</span><span class="p">;</span>
</span><span class='line'>                <span class="k">right</span><span class="o">:</span> <span class="m">10px</span><span class="p">;</span>
</span><span class='line'>                <span class="k">top</span><span class="o">:</span> <span class="m">18px</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.content</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">text-align</span><span class="o">:</span> <span class="k">center</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.title</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">font-size</span><span class="o">:</span> <span class="m">84px</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.links</span> <span class="o">&gt;</span> <span class="nt">a</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">color</span><span class="o">:</span> <span class="m">#636b6f</span><span class="p">;</span>
</span><span class='line'>                <span class="k">padding</span><span class="o">:</span> <span class="m">0</span> <span class="m">25px</span><span class="p">;</span>
</span><span class='line'>                <span class="k">font-size</span><span class="o">:</span> <span class="m">13px</span><span class="p">;</span>
</span><span class='line'>                <span class="k">font-weight</span><span class="o">:</span> <span class="m">600</span><span class="p">;</span>
</span><span class='line'>                <span class="k">letter-spacing</span><span class="o">:</span> <span class="o">.</span><span class="m">1</span><span class="n">rem</span><span class="p">;</span>
</span><span class='line'>                <span class="k">text-decoration</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
</span><span class='line'>                <span class="k">text-transform</span><span class="o">:</span> <span class="k">uppercase</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="nc">.m-b-md</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">30px</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="nt">&lt;/style&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/head&gt;</span>
</span><span class='line'>    <span class="nt">&lt;body&gt;</span>
</span><span class='line'>        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;flex-center position-ref full-height&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;content&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;title m-b-md&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>                    Welcome
</span><span class='line'>                <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;links&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>                    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://ruan.dev&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>About Me<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>                <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>            <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Our <code>configs/nginx.conf</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>user  nginx;
</span><span class='line'>worker_processes  auto;
</span><span class='line'>error_log  /var/log/nginx/error.log notice;
</span><span class='line'>pid        /var/run/nginx.pid;
</span><span class='line'>
</span><span class='line'>events {
</span><span class='line'>    worker_connections  1024;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>http {
</span><span class='line'>    include       /etc/nginx/mime.types;
</span><span class='line'>    default_type  application/octet-stream;
</span><span class='line'>
</span><span class='line'>    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;
</span><span class='line'>                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;
</span><span class='line'>                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;
</span><span class='line'>
</span><span class='line'>    access_log  /var/log/nginx/access.log  main;
</span><span class='line'>    sendfile        on;
</span><span class='line'>    keepalive_timeout  65;
</span><span class='line'>
</span><span class='line'>    include /etc/nginx/conf.d/app.conf;
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>And lastly, our <code>configs/app.conf</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>server {
</span><span class='line'>  listen 80;
</span><span class='line'>  server_name _;
</span><span class='line'>
</span><span class='line'>  location / {
</span><span class='line'>    root   /usr/share/nginx/html;
</span><span class='line'>    index  index.html;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  location /healthz {
</span><span class='line'>    return 200 &#39;up&#39;;
</span><span class='line'>  }
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<h2>Deployment</h2>

<p>Once everything is in place, or if you want to clone my repository, you can do that by:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>git clone https://github.com/ruanbekker/terraform-docker-container-example
</span><span class='line'>cd terraform-docker-container-example
</span></code></pre></td></tr></table></div></figure>


<p>Then we can initialize terraform by fetching the required plugins:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>terraform init
</span></code></pre></td></tr></table></div></figure>


<p>Once that completes we can run a plan:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>terraform plan
</span></code></pre></td></tr></table></div></figure>


<p>And that should output something more or less like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with
</span><span class='line'>the following symbols:
</span><span class='line'>  + create
</span><span class='line'>
</span><span class='line'>Terraform will perform the following actions:
</span><span class='line'>
</span><span class='line'>  # docker_container.nginx will be created
</span><span class='line'>  + resource &quot;docker_container&quot; &quot;nginx&quot; {
</span><span class='line'>      + attach                = false
</span><span class='line'>      + bridge                = (known after apply)
</span><span class='line'>      + command               = (known after apply)
</span><span class='line'>      + container_logs        = (known after apply)
</span><span class='line'>      + destroy_grace_seconds = 30
</span><span class='line'>      + entrypoint            = (known after apply)
</span><span class='line'>      + env                   = [
</span><span class='line'>          + &quot;PGID=20&quot;,
</span><span class='line'>          + &quot;PUID=501&quot;,
</span><span class='line'>        ]
</span><span class='line'>      + exit_code             = (known after apply)
</span><span class='line'>      + gateway               = (known after apply)
</span><span class='line'>      + hostname              = (known after apply)
</span><span class='line'>      + id                    = (known after apply)
</span><span class='line'>      + image                 = &quot;nginx:stable-alpine&quot;
</span><span class='line'>      + init                  = (known after apply)
</span><span class='line'>      + ip_address            = (known after apply)
</span><span class='line'>      + ip_prefix_length      = (known after apply)
</span><span class='line'>      + ipc_mode              = (known after apply)
</span><span class='line'>      + log_driver            = &quot;json-file&quot;
</span><span class='line'>      + logs                  = false
</span><span class='line'>      + memory                = 256
</span><span class='line'>      + must_run              = true
</span><span class='line'>      + name                  = &quot;nginx&quot;
</span><span class='line'>      + network_data          = (known after apply)
</span><span class='line'>      + read_only             = false
</span><span class='line'>      + remove_volumes        = true
</span><span class='line'>      + restart               = &quot;unless-stopped&quot;
</span><span class='line'>      + rm                    = false
</span><span class='line'>      + security_opts         = (known after apply)
</span><span class='line'>      + shm_size              = (known after apply)
</span><span class='line'>      + start                 = true
</span><span class='line'>      + stdin_open            = false
</span><span class='line'>      + tty                   = false
</span><span class='line'>
</span><span class='line'>      + healthcheck {
</span><span class='line'>          + interval     = (known after apply)
</span><span class='line'>          + retries      = (known after apply)
</span><span class='line'>          + start_period = (known after apply)
</span><span class='line'>          + test         = (known after apply)
</span><span class='line'>          + timeout      = (known after apply)
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.docker.network&quot;
</span><span class='line'>          + value = &quot;docknet&quot;
</span><span class='line'>        }
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.enable&quot;
</span><span class='line'>          + value = &quot;true&quot;
</span><span class='line'>        }
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.frontend.rule&quot;
</span><span class='line'>          + value = (known after apply)
</span><span class='line'>        }
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.port&quot;
</span><span class='line'>          + value = &quot;80&quot;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      + networks_advanced {
</span><span class='line'>          + aliases = [
</span><span class='line'>              + &quot;docknet&quot;,
</span><span class='line'>            ]
</span><span class='line'>          + name    = &quot;docknet&quot;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      + volumes {
</span><span class='line'>          + container_path = &quot;/etc/nginx/conf.d/app.conf&quot;
</span><span class='line'>          + host_path      = &quot;/Users/ruan/personal/terraform-playground/docker-containers/configs/app.conf&quot;
</span><span class='line'>        }
</span><span class='line'>      + volumes {
</span><span class='line'>          + container_path = &quot;/etc/nginx/nginx.conf&quot;
</span><span class='line'>          + host_path      = &quot;/Users/ruan/personal/terraform-playground/docker-containers/configs/nginx.conf&quot;
</span><span class='line'>        }
</span><span class='line'>      + volumes {
</span><span class='line'>          + container_path = &quot;/usr/share/nginx/html&quot;
</span><span class='line'>          + host_path      = &quot;/Users/ruan/personal/terraform-playground/docker-containers/html&quot;
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>  # docker_container.traefik will be created
</span><span class='line'>  + resource &quot;docker_container&quot; &quot;traefik&quot; {
</span><span class='line'>      + attach                = false
</span><span class='line'>      + bridge                = (known after apply)
</span><span class='line'>      + command               = [
</span><span class='line'>          + &quot;--api&quot;,
</span><span class='line'>          + &quot;--docker&quot;,
</span><span class='line'>          + &quot;--docker.watch&quot;,
</span><span class='line'>          + &quot;--entrypoints=Name:http Address::80&quot;,
</span><span class='line'>          + &quot;--logLevel=INFO&quot;,
</span><span class='line'>        ]
</span><span class='line'>      + container_logs        = (known after apply)
</span><span class='line'>      + destroy_grace_seconds = 30
</span><span class='line'>      + entrypoint            = (known after apply)
</span><span class='line'>      + env                   = (known after apply)
</span><span class='line'>      + exit_code             = (known after apply)
</span><span class='line'>      + gateway               = (known after apply)
</span><span class='line'>      + hostname              = (known after apply)
</span><span class='line'>      + id                    = (known after apply)
</span><span class='line'>      + image                 = &quot;traefik:1.7.14&quot;
</span><span class='line'>      + init                  = (known after apply)
</span><span class='line'>      + ip_address            = (known after apply)
</span><span class='line'>      + ip_prefix_length      = (known after apply)
</span><span class='line'>      + ipc_mode              = (known after apply)
</span><span class='line'>      + log_driver            = &quot;json-file&quot;
</span><span class='line'>      + logs                  = false
</span><span class='line'>      + memory                = 256
</span><span class='line'>      + must_run              = true
</span><span class='line'>      + name                  = &quot;traefik&quot;
</span><span class='line'>      + network_data          = (known after apply)
</span><span class='line'>      + read_only             = false
</span><span class='line'>      + remove_volumes        = true
</span><span class='line'>      + restart               = &quot;unless-stopped&quot;
</span><span class='line'>      + rm                    = false
</span><span class='line'>      + security_opts         = (known after apply)
</span><span class='line'>      + shm_size              = (known after apply)
</span><span class='line'>      + start                 = true
</span><span class='line'>      + stdin_open            = false
</span><span class='line'>      + tty                   = false
</span><span class='line'>
</span><span class='line'>      + healthcheck {
</span><span class='line'>          + interval     = (known after apply)
</span><span class='line'>          + retries      = (known after apply)
</span><span class='line'>          + start_period = (known after apply)
</span><span class='line'>          + test         = (known after apply)
</span><span class='line'>          + timeout      = (known after apply)
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.docker.network&quot;
</span><span class='line'>          + value = &quot;docknet&quot;
</span><span class='line'>        }
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.enable&quot;
</span><span class='line'>          + value = &quot;true&quot;
</span><span class='line'>        }
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.frontend.rule&quot;
</span><span class='line'>          + value = &quot;Host:traefik.localdns.xyz&quot;
</span><span class='line'>        }
</span><span class='line'>      + labels {
</span><span class='line'>          + label = &quot;traefik.port&quot;
</span><span class='line'>          + value = &quot;8080&quot;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      + networks_advanced {
</span><span class='line'>          + aliases = [
</span><span class='line'>              + &quot;docknet&quot;,
</span><span class='line'>            ]
</span><span class='line'>          + name    = &quot;docknet&quot;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      + ports {
</span><span class='line'>          + external = 80
</span><span class='line'>          + internal = 80
</span><span class='line'>          + ip       = &quot;0.0.0.0&quot;
</span><span class='line'>          + protocol = &quot;tcp&quot;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      + volumes {
</span><span class='line'>          + container_path = &quot;/var/run/docker.sock&quot;
</span><span class='line'>          + host_path      = &quot;/var/run/docker.sock&quot;
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>  # docker_image.nginx will be created
</span><span class='line'>  + resource &quot;docker_image&quot; &quot;nginx&quot; {
</span><span class='line'>      + id          = (known after apply)
</span><span class='line'>      + latest      = (known after apply)
</span><span class='line'>      + name        = &quot;nginx:stable-alpine&quot;
</span><span class='line'>      + output      = (known after apply)
</span><span class='line'>      + repo_digest = (known after apply)
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>  # docker_image.traefik will be created
</span><span class='line'>  + resource &quot;docker_image&quot; &quot;traefik&quot; {
</span><span class='line'>      + id          = (known after apply)
</span><span class='line'>      + latest      = (known after apply)
</span><span class='line'>      + name        = &quot;traefik:1.7.14&quot;
</span><span class='line'>      + output      = (known after apply)
</span><span class='line'>      + repo_digest = (known after apply)
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>  # docker_network.nginx will be created
</span><span class='line'>  + resource &quot;docker_network&quot; &quot;nginx&quot; {
</span><span class='line'>      + driver      = &quot;bridge&quot;
</span><span class='line'>      + id          = (known after apply)
</span><span class='line'>      + internal    = (known after apply)
</span><span class='line'>      + ipam_driver = &quot;default&quot;
</span><span class='line'>      + name        = &quot;docknet&quot;
</span><span class='line'>      + options     = (known after apply)
</span><span class='line'>      + scope       = (known after apply)
</span><span class='line'>
</span><span class='line'>      + ipam_config {
</span><span class='line'>          + aux_address = (known after apply)
</span><span class='line'>          + gateway     = (known after apply)
</span><span class='line'>          + ip_range    = (known after apply)
</span><span class='line'>          + subnet      = (known after apply)
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>  # random_string.nginx will be created
</span><span class='line'>  + resource &quot;random_string&quot; &quot;nginx&quot; {
</span><span class='line'>      + id          = (known after apply)
</span><span class='line'>      + length      = 8
</span><span class='line'>      + lower       = true
</span><span class='line'>      + min_lower   = 0
</span><span class='line'>      + min_numeric = 0
</span><span class='line'>      + min_special = 0
</span><span class='line'>      + min_upper   = 0
</span><span class='line'>      + number      = true
</span><span class='line'>      + result      = (known after apply)
</span><span class='line'>      + special     = false
</span><span class='line'>      + upper       = false
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>Plan: 6 to add, 0 to change, 0 to destroy.
</span><span class='line'>
</span><span class='line'>Changes to Outputs:
</span><span class='line'>  + nginx_container_name   = &quot;nginx&quot;
</span><span class='line'>  + nginx_url              = (known after apply)
</span><span class='line'>  + traefik_container_name = &quot;traefik&quot;
</span><span class='line'>  + traefik_url            = &quot;http://traefik.localdns.xyz/&quot;
</span></code></pre></td></tr></table></div></figure>


<p>Which we can see will create 2 containers, traefik and then nginx, map the configs and html in place and also sets the traefik hostname in the labels for our respective containers so that we can reach them via the specific host headers.</p>

<p>The we can deploy our containers:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>terraform apply -auto-approve
</span></code></pre></td></tr></table></div></figure>


<p>Which will provide us the output detail defined from our <code>outputs.tf</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>Apply complete! Resources: 6 added, 0 changed, 0 destroyed.
</span><span class='line'>
</span><span class='line'>Outputs:
</span><span class='line'>
</span><span class='line'>nginx_container_name = &quot;nginx&quot;
</span><span class='line'>nginx_url = &quot;http://www.5igjdfq9.localdns.xyz/&quot;
</span><span class='line'>traefik_container_name = &quot;traefik&quot;
</span><span class='line'>traefik_url = &quot;http://traefik.localdns.xyz/&quot;
</span></code></pre></td></tr></table></div></figure>


<h2>Access our Containers</h2>

<p>We can access our Traefik Dashboard on <a href="http://traefik.localdns.xyz">http://traefik.localdns.xyz</a> and should look something like this:</p>

<p><img src="https://user-images.githubusercontent.com/567298/143064031-23e9dbe4-522b-4f11-96f9-f30a2104ee44.png" alt="image" /></p>

<p>And when we access our Nginx container on <a href="http://www.5igjdfq9.localdns.xyz">http://www.5igjdfq9.localdns.xyz</a> it should look more or less like this:</p>

<p><img src="https://user-images.githubusercontent.com/567298/143064228-88107b75-31fc-41eb-aee0-f26ff976c42a.png" alt="image" /></p>

<p>Running a <code>docker ps</code> will show our running containers:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>docker ps
</span><span class='line'>CONTAINER ID   IMAGE                  COMMAND                  CREATED         STATUS                PORTS                NAMES
</span><span class='line'>e45158ae8cba   nginx:stable-alpine    &quot;/docker-entrypoint   3 minutes ago   Up 3 minutes          80/tcp               nginx
</span><span class='line'>ebdbe42a0fcb   traefik:1.7.14         &quot;/traefik --api       3 minutes ago   Up 3 minutes          0.0.0.0:80-&gt;80/tcp   traefik
</span></code></pre></td></tr></table></div></figure>


<h2>Cleanup</h2>

<p>We can delete our containers by running:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>terraform destroy -auto-approve
</span></code></pre></td></tr></table></div></figure>


<h2>Thank You</h2>

<p>Thanks for reading, if you like my content, check out my <strong><a href="https://ruan.dev">website</a></strong> or follow me at <strong><a href="https://twitter.com/ruanbekker">@ruanbekker</a></strong> on Twitter.</p>
</div>


  <footer>
    <p class="meta">
      
  


<span class="byline author vcard">Posted by <span class="fn">Ruan</span></span>
<script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ruanbekker" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting, if you like my content, feel free to support me with a digital coffee." data-color="#FFDD00" data-position="Right" data-x_margin="18" data-y_margin="18"></script>


      




<time class='entry-date' datetime='2021-11-23T11:06:03-05:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2021</span></span> <span class='time'>11:06 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/docker/'>docker</a>, <a class='category' href='/blog/categories/nginx/'>nginx</a>, <a class='category' href='/blog/categories/terraform/'>terraform</a>, <a class='category' href='/blog/categories/traefik/'>traefik</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="https://blog.ruanbekker.com/blog/2021/11/23/run-docker-containers-with-terraform/" data-via="ruanbekker" data-counturl="https://blog.ruanbekker.com/blog/2021/11/23/run-docker-containers-with-terraform/" >Tweet</a>
  
  
  
</div>

    
    <!-- https://www.undefinednull.com/2013/10/15/octopress-blog-tweaks-adding-author-information-section-below-each-posts/ -->
    <div class="about">
     <span class="about-image">
          <img src="/images/author.png" alt="Ruan Bekker">
     </span>
     <span class="about-desc">
          <span>My name is <a href="https://ruan.dev">Ruan</a>, I'm a DevOps Engineer from South Africa. I'm passionate
          about AWS, OpenSource, Observability, Containers, Linux, Automation and sharing my findings with the world.
          More info about me on my website, <a href="https://ruan.dev">ruan.dev</a>.</span>
          <br/>
          <hr/>
          <a href="https://twitter.com/ruanbekker" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @ruanbekker</a>
     </span>
</div>

    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2021/11/03/setup-traefik-version-2-on-docker/" title="Previous Post: Setup Traefik Version 2 on Docker">&laquo; Setup Traefik Version 2 on Docker</a>
      
      
        <a class="basic-alignment right" href="/blog/2021/12/05/run-a-geth-ethereum-light-node/" title="Next Post: Run a GETH Ethereum Light Node">Run a GETH Ethereum Light Node &raquo;</a>
      
    </p>
  </footer>
</article>
<!-- google advertisements
    <script data-ad-client="ca-pub-1100086574264181" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- old
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-1543437721119411",
        enable_page_level_ads: true
      });
    </script>
    -->

 
-->


  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Subscribe</h1>
  <!-- Begin MailChimp Signup Form -->
  <div id="mc_embed_signup">
  <form action="https://sysadmins.us15.list-manage.com/subscribe/post?u=3dfcff447b6ee598231eeb658&amp;id=3542f323a9" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
      <div class="indicates-required"><span class="asterisk"></span></div>
      <div class="mc-field-group">
	<label for="mce-EMAIL">Email Address:  <span class="asterisk"></span>
        </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
        </div>
	<div id="mce-responses" class="clear">
	  <div class="response" id="mce-error-response" style="display:none"></div>
	  <div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3dfcff447b6ee598231eeb658_3542f323a9" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
  </form>
</div>
<!--End mc_embed_signup-->
</section>

<section>
  <h1>Slack</h1>
  Join me on <a href="http://linux-hackers.slack.com">Slack</a>
</section>

<section>
  <h1>Twitter</h1>
  Follow me on Twitter: <a href="https://twitter.com/ruanbekker">@ruanbekker</a>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2021/12/05/run-a-geth-ethereum-light-node/">Run a GETH Ethereum Light Node</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/11/23/run-docker-containers-with-terraform/">Run Docker Containers With Terraform</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/11/03/setup-traefik-version-2-on-docker/">Setup Traefik Version 2 on Docker</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/10/11/install-nodejs-on-linux-using-nvm/">Install Nodejs on Linux Using NVM</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/10/10/setup-basic-authentication-on-node-exporter-and-prometheus/">Setup TLS and Basic Authentication on Node Exporter for Prometheus</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Store</h1>
  <ul id=""></ul>
  <p></p>
  <strong>Check out my Store</strong>: Have a look at my latest cheatsheets in PDF format.
  <p></p>
  <a href="https://ruan.dev/store/elasticsearch-cheatsheet/?source=blog.ruanbekker.com"><img src="https://user-images.githubusercontent.com/567298/97010485-c2334a00-1545-11eb-9e1d-2333e5148da1.png" width="290" height="900"></a>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2021 - Ruan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>



  <li>
    <a href="https://twitter.com/ruanbekker">
      <i class="fa fa-twitter"></i> Twitter
    </a>
  </li>



  <li>
    <a href="https://github.com/ruanbekker">
      <i class="fa fa-github"></i> GitHub
    </a>
  </li>



  <li>
    <a href="https://sysadmins.co.za">
      <i class="fa fa-bars"></i> My HowTo Blog
    </a>
  </li>


</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'blog-ruanbekker';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://blog.ruanbekker.com/blog/2021/11/23/run-docker-containers-with-terraform/';
        var disqus_url = 'https://blog.ruanbekker.com/blog/2021/11/23/run-docker-containers-with-terraform/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





      <script data-ad-client="ca-pub-1100086574264181" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- old
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-1543437721119411",
        enable_page_level_ads: true
      });
    </script>
    -->


</body>
</html>
