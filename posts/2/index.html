
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ruan Bekker's Blog</title>
  <meta name="author" content="Ruan">

  
  <meta name="description" content="In Concourse, Resources refer to external resource types such as s3, github etc. So for example, we can run a pipeline which pulls data from github &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <!-- font awesome --!>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="canonical" href="http://blog.ruanbekker.com/posts/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Ruan Bekker's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-105336110-1']);
    _gaq.push(['_setDomainName','ruanbekker.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ruan Bekker's Blog</a></h1>
  
    <h2>From a Curious mind to Posts on Github</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://blog.ruanbekker.com/search/" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="blog.ruanbekker.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories/aws/">AWS</a></li>
  <li><a href="/blog/categories/docker/">Docker</a></li>
  <li><a href="/blog/categories/devops/">DevOps</a></li>
  <li><a href="/blog/categories/python/">Python</a></li>
  <li><a target="_blank" href="https://sysadmins.co.za">My Sysadmins Blog</a></li>
  <li><a href="/awesome-links/">Awesome Links</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/14/concourse-pipeline-with-resources-tutorial/">Concourse Pipeline With Resources Tutorial</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-14T15:58:10-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>3:58 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="https://i.snag.gy/gzkdu9.jpg?nocache=1511644783495" alt="" /></p>

<p>In Concourse, Resources refer to external resource types such as <code>s3</code>, <code>github</code> etc.</p>

<p>So for example, we can run a pipeline which pulls data from github, such as cloning a repository, so in other words the data that was cloned from the github repository is within the container where your tasks will be executed.</p>

<h2>Concourse Github Resourse Example</h2>

<p>In this tutorial we will use the github resource type, in conjunction with a task that will execute a script, where the script will be inside the github repository.</p>

<p>Our pipeline as <code>pipeline.yml</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
</span><span class='line'><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">concourse-tutorial</span>
</span><span class='line'>  <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">git</span>
</span><span class='line'>  <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">uri</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">https://github.com/ruanbekker/concourse-tutorial.git</span>
</span><span class='line'>    <span class="l-Scalar-Plain">branch</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">master</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">jobs</span><span class="p-Indicator">:</span>
</span><span class='line'><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">job-hello-world</span>
</span><span class='line'>  <span class="l-Scalar-Plain">public</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
</span><span class='line'>  <span class="l-Scalar-Plain">plan</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">get</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">concourse-tutorial</span>
</span><span class='line'>  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">task</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">hello-world</span>
</span><span class='line'>    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">concourse-tutorial/00-basic-tasks/task_hello_world.yml</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can head over to <a href="https://raw.githubusercontent.com/ruanbekker/concourse-tutorial/master/00-basic-tasks/task_hello_world.yml">hello-world</a> task on github to see the task, but all it does is running a <code>uname -a</code></p>

<p>So our job has a task that will call the action defined in our <code>task_hello_world.yml</code> which retrieves it from the <code>get</code> step, as you can see it&rsquo;s the <code>concourse-tutorial</code> resource, which is defined under the resources section as a git resource type.</p>

<p>Set the pipeline:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>fly -t ci sp -c pipeline.yml -p 04-hello-world
</span><span class='line'>
</span><span class='line'>apply configuration? <span class="o">[</span>yN<span class="o">]</span>: y
</span><span class='line'>pipeline created!
</span></code></pre></td></tr></table></div></figure>


<p>Unpause the pipeline:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>fly -t ci up -p 04-hello-world
</span><span class='line'>unpaused <span class="s1">&#39;04-hello-world&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Trigger the job (trigger is off; default)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>fly -t ci tj -j 04-hello-world/job-hello-world --watch
</span><span class='line'>started 04-hello-world/job-hello-world <span class="c">#4</span>
</span><span class='line'>
</span><span class='line'>initializing
</span><span class='line'>running uname -a
</span><span class='line'>Linux 6a91b808-c488-4e3c-7b51-404f73405c31 4.9.0-8-amd64 <span class="c">#1 SMP Debian 4.9.110-3+deb9u4 (2018-08-21) x86_64 GNU/Linux</span>
</span><span class='line'>succeeded
</span></code></pre></td></tr></table></div></figure>


<p>So this job cloned the github repository, called the task file which calls the bash script from th github repository to run <code>uname -a</code></p>

<p>For my other content on concourse, have a look at the <a href="https://blog.ruanbekker.com/blog/categories/concourse/">concourse</a> category.</p>

<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/14/how-to-cache-data-with-python-flask/">How to Cache Data With Python Flask</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-14T06:37:30-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>6:37 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="https://user-images.githubusercontent.com/567298/52816968-216f6480-30ab-11e9-9d19-6418ba51563b.png" alt="" /></p>

<p>If you depending on a external source to return static data you can implement <code>cachetools</code> to cache data from preventing the overhead to make the request everytime you make a request to Flask.</p>

<p>This is useful when your upstream data does not change often. This is configurable with <code>maxsize</code> and <code>ttl</code> so whenever the first one&rsquo;s threshold is met, the application will fetch new data whenever the request has been made to your application.</p>

<h2>Example</h2>

<p>Let&rsquo;s build a basic flask application that will return the data from our <code>data.txt</code> file to the client:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">cachetools</span> <span class="kn">import</span> <span class="n">cached</span><span class="p">,</span> <span class="n">TTLCache</span>
</span><span class='line'>
</span><span class='line'><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</span><span class='line'><span class="n">cache</span> <span class="o">=</span> <span class="n">TTLCache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nd">@cached</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span>
</span><span class='line'><span class="k">def</span> <span class="nf">read_data</span><span class="p">():</span>
</span><span class='line'>    <span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;data.txt&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">data</span>
</span><span class='line'>
</span><span class='line'><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span class='line'>    <span class="n">get_data</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">()</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">get_data</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
</span><span class='line'>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create the local file with some data:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>touch data.txt
</span><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;version1&quot;</span> &gt; data.txt
</span></code></pre></td></tr></table></div></figure>


<p>Start the server:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>python app.py
</span></code></pre></td></tr></table></div></figure>


<p>Make the request:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl http://localhost:5000/
</span><span class='line'>version1
</span></code></pre></td></tr></table></div></figure>


<p>Change the data inside the file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;version2&quot;</span> &gt; data.txt
</span></code></pre></td></tr></table></div></figure>


<p>Make the request again:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl http://localhost:5000/
</span><span class='line'>version1
</span></code></pre></td></tr></table></div></figure>


<p>As the ttl is set to 60, wait for 60 seconds so that the item kan expire from the cache and try again:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl http://localhost:5000/
</span><span class='line'>version2
</span></code></pre></td></tr></table></div></figure>


<p>As you can see the cache expired and a new request has been made to read the file again and load it in cache, and then return to the client.</p>

<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/12/concourse-tasks-and-inputs-tutorial/">Concourse Tasks and Inputs Tutorial</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-12T14:57:27-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>2:57 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="https://i.snag.gy/gzkdu9.jpg?nocache=1511644783495" alt="" /></p>

<p>In this tutorial I will show you how to execute task scripts and using task inputs to have the ability to pass data to concourse for processing.</p>

<p>For my other content on concourse, have a look at the <a href="https://i.snag.gy/gzkdu9.jpg?nocache=1511644783495">concourse</a> category.</p>

<h2>Task Inputs</h2>

<p>First, let&rsquo;s run a task on concourse that does not rely on any inputs.</p>

<figure class='code'><figcaption><span>no_inputs.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">platform</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">linux</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">image_resource</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">docker-image</span>
</span><span class='line'>  <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span><span class="nv">repository</span><span class="p-Indicator">:</span> <span class="nv">busybox</span><span class="p-Indicator">}</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">run</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">uname</span>
</span><span class='line'><span class="l-Scalar-Plain">args</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&quot;-a&quot;</span><span class="p-Indicator">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running execute with the configuration from above:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>fly -t ci e -c no_inputs.yml
</span><span class='line'>
</span><span class='line'>executing build <span class="m">37</span> at http://10.20.30.40/builds/37
</span><span class='line'>initializing
</span><span class='line'>running uname -a
</span><span class='line'>Linux 2fd4e261-a708-4e15-4a4a-2bc50221a664 4.9.0-8-amd64 <span class="c">#1 SMP Debian 4.9.110-3+deb9u4 (2018-08-21) x86_64 GNU/Linux</span>
</span><span class='line'>succeeded
</span></code></pre></td></tr></table></div></figure>


<p>As you can see we have executed the command <code>uname -a</code> on one of the containers in Concourse.</p>

<h2>Tasks Inputs: Specify Path</h2>

<p>Now lets say, we have data that needs to be transferred to the container where we are running our tasks. For that we are using inputs.</p>

<p>In this example, we will set the input parameter in our task definition, and override the path with the cli. We will create a couple of files in a folder, then list them in the container where the task is running.</p>

<p>Creating the data:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mkdir my-data-folder
</span><span class='line'><span class="nv">$ </span>touch my-data-folder/test1.txt my-data-folder/test2.txt
</span></code></pre></td></tr></table></div></figure>


<p>Our task definition:</p>

<figure class='code'><figcaption><span>inputs_required.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">platform</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">linux</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">image_resource</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">docker-image</span>
</span><span class='line'>  <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span><span class="nv">repository</span><span class="p-Indicator">:</span> <span class="nv">busybox</span><span class="p-Indicator">}</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">inputs</span><span class="p-Indicator">:</span>
</span><span class='line'><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">my-input</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">run</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ls</span>
</span><span class='line'>  <span class="l-Scalar-Plain">args</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&#39;-alR&#39;</span><span class="p-Indicator">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see our input name is called <code>my-input</code> and we will use the cli to map the local folder <code>my-data-folder</code> to the parameter name:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>fly -t ci e -c inputs_required.yml -i my-input<span class="o">=</span>./my-data-folder/
</span><span class='line'>
</span><span class='line'>executing build <span class="m">32</span> at http://10.20.30.40/builds/32
</span><span class='line'>initializing
</span><span class='line'>my-input: 262.13 KiB/s 0s
</span><span class='line'>running ls -alR
</span><span class='line'>.:
</span><span class='line'>total 0
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">16</span> Feb <span class="m">10</span> 08:53 .
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">16</span> Feb <span class="m">10</span> 08:53 ..
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">36</span> Feb <span class="m">10</span> 08:53 my-input
</span><span class='line'>
</span><span class='line'>./my-input:
</span><span class='line'>total 0
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">36</span> Feb <span class="m">10</span> 08:53 .
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">16</span> Feb <span class="m">10</span> 08:53 ..
</span><span class='line'>-rw-r--r--    <span class="m">1</span> <span class="m">501</span>      staff            <span class="m">0</span> Feb <span class="m">10</span> 08:52 test1.txt
</span><span class='line'>-rw-r--r--    <span class="m">1</span> <span class="m">501</span>      staff            <span class="m">0</span> Feb <span class="m">10</span> 08:52 test2.txt
</span><span class='line'>succeeded
</span></code></pre></td></tr></table></div></figure>


<p>As you can see from the above output, the folder was uploaded and placed inside the container where we ran our task.</p>

<h2>Task Inputs: Parent Directory</h2>

<p>Then we can use parent directories. Running a task that relies on the input path which will be our current working directory. Note: the input name should be the same as the current working directory</p>

<p>The input name will be the only thing that differs, which will look like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>inputs:
</span><span class='line'>- name: my-data-folder
</span></code></pre></td></tr></table></div></figure>


<p>Running the task:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">cd </span>my-data-folder
</span><span class='line'><span class="nv">$ </span>fly -t ci e -c ../input_parent_dir.yml
</span><span class='line'>
</span><span class='line'>executing build <span class="m">35</span> at http://10.20.30.40/builds/35
</span><span class='line'>initializing
</span><span class='line'>my-data-folder: 395.85 KiB/s 0s
</span><span class='line'>running ls -alR
</span><span class='line'>.:
</span><span class='line'>total 0
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">38</span> Feb <span class="m">10</span> 09:17 .
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">16</span> Feb <span class="m">10</span> 09:17 ..
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">18</span> Feb <span class="m">10</span> 09:17 my-data-folder
</span><span class='line'>
</span><span class='line'>./my-data-folder:
</span><span class='line'>total 0
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">18</span> Feb <span class="m">10</span> 09:17 .
</span><span class='line'>drwxr-xr-x    <span class="m">1</span> root     root            <span class="m">38</span> Feb <span class="m">10</span> 09:17 ..
</span><span class='line'>-rw-r--r--    <span class="m">1</span> <span class="m">501</span>      staff            <span class="m">0</span> Feb <span class="m">10</span> 09:15 test1.txt
</span><span class='line'>-rw-r--r--    <span class="m">1</span> <span class="m">501</span>      staff            <span class="m">0</span> Feb <span class="m">10</span> 09:15 test2.txt
</span><span class='line'>succeeded
</span></code></pre></td></tr></table></div></figure>


<p>The source code for this can be found at <a href="https://github.com/ruanbekker/concourse-tutorial/tree/master/02-task-inputs">https://github.com/ruanbekker/concourse-tutorial/tree/master/02-task-inputs</a></p>

<h2>Task Scripts:</h2>

<p>In conjunction with inputs, we can let our task configuration reference a script that we want to execute, and using inputs, we can upload the current working directory to concourse, so then the container has context about the data that it needs.</p>

<p>Our task configuration <code>task_show_hostname.yml</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>platform: linux
</span><span class='line'>
</span><span class='line'>image_resource:
</span><span class='line'>  <span class="nb">type</span>: docker-image
</span><span class='line'>  <span class="nb">source</span>: <span class="o">{</span>repository: busybox<span class="o">}</span>
</span><span class='line'>
</span><span class='line'>inputs:
</span><span class='line'>- name: 03-task-scripts
</span><span class='line'>
</span><span class='line'>run:
</span><span class='line'>  path: ./03-task-scripts/task_show_hostname.sh
</span></code></pre></td></tr></table></div></figure>


<p>Our executable script <code>03-task-scripts/task_show_hostname.sh</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'>
</span><span class='line'><span class="nv">get_hostname</span><span class="o">=</span><span class="k">$(</span>hostname<span class="k">)</span>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;Hostname is: ${get_hostname}&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Make sure to apply the executable permissions to the script:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>chmod +x 03-task-scripts/task_show_hostname.sh
</span></code></pre></td></tr></table></div></figure>


<p>With this configuration, it uploads the current working directory to concourse, and the data inside the directory gets placed on the container&rsquo;s working directory: 03-task-scripts, which is the name of the input.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>fly -t ci e -c 03-task-scripts/task_show_hostname.yml
</span><span class='line'>
</span><span class='line'>executing build <span class="m">39</span> at http://10.20.30.40/builds/39
</span><span class='line'>initializing
</span><span class='line'>03-task-scripts: 347.15 KiB/s 0s
</span><span class='line'>running ./03-task-scripts/task_show_hostname.sh
</span><span class='line'>Hostname is: 3ccb3c28-d452-4068-5ea1-101153803d93
</span><span class='line'>succeeded
</span></code></pre></td></tr></table></div></figure>


<p>The source code for this example can be found at <a href="https://github.com/ruanbekker/concourse-tutorial/tree/master/03-task-scripts">https://github.com/ruanbekker/concourse-tutorial/tree/master/03-task-scripts</a></p>

<p>That&rsquo;s it for Task Inputs and Task Scripts on Concourse, please feel free to have a look at my other content about <a href="http://blog.ruanbekker.com/blog/categories/concourse/">Concourse</a></p>

<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/10/sysadmin-linux-troubleshooting-cheatsheet/">Sysadmin Linux Troubleshooting Cheatsheet</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-10T14:17:54-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>2:17 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a one pager of all the commands I use when I have to troubleshoot problems. This post will be updated as time goes by.</p>

<h2>Curl / Web Response Times</h2>

<p>Template file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>cat curl-format.txt
</span><span class='line'>time_namelookup:  %<span class="o">{</span>time_namelookup<span class="o">}</span><span class="se">\n</span>
</span><span class='line'>time_connect:  %<span class="o">{</span>time_connect<span class="o">}</span><span class="se">\n</span>
</span><span class='line'>time_appconnect:  %<span class="o">{</span>time_appconnect<span class="o">}</span><span class="se">\n</span>
</span><span class='line'>time_pretransfer:  %<span class="o">{</span>time_pretransfer<span class="o">}</span><span class="se">\n</span>
</span><span class='line'>time_redirect:  %<span class="o">{</span>time_redirect<span class="o">}</span><span class="se">\n</span>
</span><span class='line'>time_starttransfer:  %<span class="o">{</span>time_starttransfer<span class="o">}</span><span class="se">\n</span>
</span><span class='line'>----------<span class="se">\n</span>
</span><span class='line'>time_total:  %<span class="o">{</span>time_total<span class="o">}</span><span class="se">\n</span>
</span></code></pre></td></tr></table></div></figure>


<p>The host header, source addres, destination address:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -sk -w <span class="s2">&quot;@curl-format.txt&quot;</span> -o /dev/null -H <span class="s2">&quot;Host: remote-host.mydomain.com&quot;</span> 10.0.2.10 https://10.244.0.240:443 -L
</span><span class='line'>
</span><span class='line'>time_namelookup:  0.012178
</span><span class='line'>time_connect:  0.012225
</span><span class='line'>time_appconnect:  0.062149
</span><span class='line'>time_pretransfer:  0.062175
</span><span class='line'>time_redirect:  0.000172
</span><span class='line'>time_starttransfer:  0.125631
</span><span class='line'>----------
</span><span class='line'>time_total:  0.125849
</span></code></pre></td></tr></table></div></figure>


<h2>MTR / Network Latencies / Packetloss</h2>

<p>No dns, TCP, counts, port, source address, destination address:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mtr -n -T -c <span class="m">10</span> --port <span class="m">443</span> 10.2.0.2 10.244.10.5 --report
</span><span class='line'>Start: Sun Feb <span class="m">10</span> 19:04:50 2019
</span><span class='line'>HOST: my-internet-gatewewy         Loss%   Snt   Last   Avg  Best  Wrst StDev
</span><span class='line'>  1.<span class="p">|</span>-- 172.18.110.22              0.0%    <span class="m">10</span>    0.3   0.3   0.3   0.3   0.0
</span><span class='line'>  2.<span class="p">|</span>-- 172.18.110.22              0.0%    <span class="m">10</span>    0.3   0.3   0.3   0.3   0.0
</span><span class='line'>  3.<span class="p">|</span>-- 172.18.110.22              0.0%    <span class="m">10</span>    0.3   0.3   0.3   0.3   0.0
</span></code></pre></td></tr></table></div></figure>


<h2>TCPTraceroute</h2>

<p>No dns, TCP, port, source address, destination address:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>traceroute -T -n -p <span class="m">443</span> -s 10.80.4.7 10.2.129.4<span class="p">;</span> <span class="k">done</span>
</span><span class='line'>traceroute to 10.2.129.4 <span class="o">(</span>10.2.129.4<span class="o">)</span>, <span class="m">30</span> hops max, <span class="m">60</span> byte packets
</span><span class='line'> <span class="m">1</span>  10.80.4.1   0.322 ms  0.291 ms  0.224 ms
</span><span class='line'> <span class="m">2</span>  10.2.129.4  179.090 ms  179.022 ms  179.023 ms
</span></code></pre></td></tr></table></div></figure>


<h2>Connection Related:</h2>

<p>Connection flow: <a href="https://askubuntu.com/questions/538443/whats-the-difference-between-port-status-listening-time-wait-close-wait">Thanks to</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Consider two programs attempting a socket connection <span class="o">(</span>call them a and b<span class="o">)</span>. Both <span class="nb">set </span>up sockets and transition to the LISTEN state. Then one program <span class="o">(</span>say a<span class="o">)</span> tries to connect to the other <span class="o">(</span>b<span class="o">)</span>. a sends a request and enters the SYN_SENT state, and b receives the request and enters the SYN_RECV state. When b acknowledges the request, they enter the ESTABLISHED state, and <span class="k">do</span> their business. Now a couple of things can happen:
</span><span class='line'>
</span><span class='line'>    a wishes to close the connection, and enters FIN_WAIT1. b receives the FIN request, sends an ACK <span class="o">(</span><span class="k">then</span> a enters FIN_WAIT2<span class="o">)</span>, enters CLOSE_WAIT, tells a it is closing down and the enters LAST_ACK. Once a acknowledges this <span class="o">(</span>and enters TIME_WAIT<span class="o">)</span>, b enters CLOSE. a waits a bit to see <span class="k">if</span> anythings is left, <span class="k">then</span> enters CLOSE.
</span><span class='line'>    a and b have finished their business and decide to close the connection <span class="o">(</span>simultaneous closing<span class="o">)</span>. When a is in FIN_WAIT, and instead of receiving an ACK from b, it receives a FIN <span class="o">(</span>as b wishes to close it as well<span class="o">)</span>, a enters CLOSING. But there are still some messages to send <span class="o">(</span>the ACK that a is supposed to get <span class="k">for</span> its original FIN<span class="o">)</span>, and once this ACK arrives, a enters TIME_WAIT as usual.
</span></code></pre></td></tr></table></div></figure>


<p>Active Connections:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>netstat -n -A  inet <span class="p">|</span> grep -v <span class="s2">&quot;127.0.0.1&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Established Connections:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>netstat -nputw <span class="p">|</span> grep ESTABLISHED
</span><span class='line'><span class="nv">$ </span>netstat -antp <span class="p">|</span> grep :3306 <span class="p">|</span> grep ESTABLISHED
</span></code></pre></td></tr></table></div></figure>


<p>Time Wait Connections:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>netstat -antp <span class="p">|</span> grep TIME_WAIT
</span></code></pre></td></tr></table></div></figure>


<p>How many connections:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>wc -l /proc/net/tcp
</span></code></pre></td></tr></table></div></figure>


<p>Listing Open files per Port:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>lsof -i:3306
</span></code></pre></td></tr></table></div></figure>


<p>Listing Open files per User:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>lsof -u glassfish
</span></code></pre></td></tr></table></div></figure>


<h2>Resources</h2>

<ul>
<li><a href="https://aws.amazon.com/premiumsupport/knowledge-center/troubleshoot-vpn-packet-loss/">AWS: Troubleshoot VPN Latencies</a></li>
<li><a href="https://www.linode.com/docs/networking/diagnostics/diagnosing-network-issues-with-mtr/">Linode: Diagnose Network Issues with MTR</a></li>
</ul>


<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/08/port-status-checker-script-in-c-language/">Port Status Checker Script in C Language</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-08T08:56:11-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>8:56 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a simple script in the C Programming Language to test the port status of a remote address.</p>

<h2>Requirements:</h2>

<p>You will need the gcc package to compile the program:</p>

<p>For RHEL based distro&rsquo;s:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>yum install gcc -y
</span></code></pre></td></tr></table></div></figure>


<p>For Debian based distro&rsquo;s:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>apt install gcc -y
</span></code></pre></td></tr></table></div></figure>


<h2>Check TCP Port Status in C Language:</h2>

<p>Our file: <code>test.c</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/socket.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;netinet/in.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;netdb.h&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">int</span> <span class="n">portno</span>     <span class="o">=</span> <span class="mi">443</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">char</span> <span class="o">*</span><span class="n">hostname</span> <span class="o">=</span> <span class="s">&quot;google.com&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">int</span> <span class="n">sockfd</span><span class="p">;</span>
</span><span class='line'>    <span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">serv_addr</span><span class="p">;</span>
</span><span class='line'>    <span class="k">struct</span> <span class="n">hostent</span> <span class="o">*</span><span class="n">server</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">sockfd</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">sockfd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">error</span><span class="p">(</span><span class="s">&quot;Error opening socket</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">server</span> <span class="o">=</span> <span class="n">gethostbyname</span><span class="p">(</span><span class="n">hostname</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">server</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;ERROR, no such host</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">bzero</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">serv_addr</span><span class="p">));</span>
</span><span class='line'>    <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span>
</span><span class='line'>    <span class="n">bcopy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">server</span><span class="o">-&gt;</span><span class="n">h_addr</span><span class="p">,</span>
</span><span class='line'>         <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span><span class="p">,</span>
</span><span class='line'>         <span class="n">server</span><span class="o">-&gt;</span><span class="n">h_length</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="n">portno</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">connect</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,(</span><span class="k">struct</span> <span class="n">sockaddr</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">serv_addr</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Port is Closed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Port is Open</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">close</span><span class="p">(</span><span class="n">sockfd</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Compile:</h2>

<p>Compile using gcc:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="err">$</span> <span class="n">gcc</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span> <span class="n">test</span><span class="p">.</span><span class="n">c</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Execute:</h2>

<p>Execute the script:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>./test
</span><span class='line'>Port is Open
</span></code></pre></td></tr></table></div></figure>


<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/07/the-aws-cli-cheatsheet-for-bash/">The AWS CLI Cheatsheet for Bash</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-07T03:24:12-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>3:24 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="https://user-images.githubusercontent.com/30043398/52399083-cdb9b580-2ac3-11e9-8c8a-79fcb811de18.png" alt="" /></p>

<p>This is a post for all the AWS CLI oneliners that I stumble upon. Note that they will be updated over time.</p>

<h2>RDS</h2>

<p>Describe All RDS DB Instances:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod rds describe-db-instances --query <span class="s1">&#39;DBInstances[*].[DBInstanceArn,DBInstanceIdentifier,DBInstanceClass,Endpoint]&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Describe a RDS DB Instance with a dbname:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod rds describe-db-instances --query <span class="s1">&#39;DBInstances[?DBInstanceIdentifier==`db-staging`].[DBInstanceArn,DBInstanceIdentifier,DBInstanceClass,Endpoint]&#39;</span>
</span><span class='line'><span class="o">[</span>
</span><span class='line'>    <span class="o">[</span>
</span><span class='line'>        <span class="s2">&quot;arn:aws:rds:eu-west-1:&lt;customer_id&gt;:db:db-staging&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;db-staging&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;db.t2.micro&quot;</span>,
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;HostedZoneId&quot;</span>: <span class="s2">&quot;ASKDJSAKDJBA&quot;</span>,
</span><span class='line'>            <span class="s2">&quot;Port&quot;</span>: 5432,
</span><span class='line'>            <span class="s2">&quot;Address&quot;</span>: <span class="s2">&quot;db-staging.asdkjahsd.eu-west-1.rds.amazonaws.com&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">]</span>
</span><span class='line'><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>List all RDS DB Instances and limit output:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod rds describe-db-instances --query <span class="s1">&#39;DBInstances[*].[DBInstanceArn,DBInstanceIdentifier,DBInstanceClass,Endpoint]&#39;</span>
</span><span class='line'><span class="o">[</span>
</span><span class='line'>    <span class="o">[</span>
</span><span class='line'>        <span class="s2">&quot;arn:aws:rds:eu-west-1:&lt;customer_id&gt;:db:db-name&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;db-name&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;db.t2.micro&quot;</span>,
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;HostedZoneId&quot;</span>: <span class="s2">&quot;ABCDEFGHILKL&quot;</span>,
</span><span class='line'>            <span class="s2">&quot;Port&quot;</span>: 5432,
</span><span class='line'>            <span class="s2">&quot;Address&quot;</span>: <span class="s2">&quot;db-name.abcdefg.eu-west-1.rds.amazonaws.com&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">]</span>,
</span></code></pre></td></tr></table></div></figure>


<p>List all RDS DB Instances that has backups enabled, and limit output:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod rds describe-db-instances --query <span class="s1">&#39;DBInstances[?BackupRetentionPeriod&gt;`0`].[DBInstanceArn,DBInstanceIdentifier,DBInstanceClass,Endpoint]&#39;</span>
</span><span class='line'><span class="o">[</span>
</span><span class='line'>    <span class="o">[</span>
</span><span class='line'>        <span class="s2">&quot;arn:aws:rds:eu-west-1:&lt;customer_id&gt;:db:db-name&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;db-name&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;db.t2.micro&quot;</span>,
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="s2">&quot;HostedZoneId&quot;</span>: <span class="s2">&quot;ABCDEFGHILKL&quot;</span>,
</span><span class='line'>            <span class="s2">&quot;Port&quot;</span>: 5432,
</span><span class='line'>            <span class="s2">&quot;Address&quot;</span>: <span class="s2">&quot;db-name.abcdefg.eu-west-1.rds.amazonaws.com&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">]</span>,
</span></code></pre></td></tr></table></div></figure>


<p>Describe DB Snapshots for DB Instance Name:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod rds describe-db-snapshots --db-instance-identifier db --query <span class="s1">&#39;DBSnapshots[?DBInstanceIdentifier==`db`].[DBInstanceIdentifier,DBSnapshotIdentifier,SnapshotCreateTime,Status]&#39;</span>
</span><span class='line'><span class="o">[</span>
</span><span class='line'>    <span class="o">[</span>
</span><span class='line'>        <span class="s2">&quot;db&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;rds:db-2018-05-16-04-08&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;2018-05-16T04:08:53.696Z&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;available&quot;</span>
</span><span class='line'>    <span class="o">]</span>,
</span></code></pre></td></tr></table></div></figure>


<p>Events for the last 24 Hours:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod rds describe-events --source-identifier <span class="s2">&quot;rds:db-2018-05-16-04-08&quot;</span> --source-type db-snapshot --duration <span class="m">1440</span> --query <span class="s1">&#39;Events[*]&#39;</span>
</span><span class='line'><span class="o">[</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;EventCategories&quot;</span>: <span class="o">[</span>
</span><span class='line'>            <span class="s2">&quot;creation&quot;</span>
</span><span class='line'>        <span class="o">]</span>,
</span><span class='line'>        <span class="s2">&quot;SourceType&quot;</span>: <span class="s2">&quot;db-snapshot&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;SourceArn&quot;</span>: <span class="s2">&quot;arn:aws:rds:eu-west-1:&lt;customer_id&gt;:snapshot:rds:db-2018-05-16-04-08&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;Date&quot;</span>: <span class="s2">&quot;2018-05-16T04:08:40.264Z&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;Message&quot;</span>: <span class="s2">&quot;Creating automated snapshot&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;SourceIdentifier&quot;</span>: <span class="s2">&quot;rds:db-2018-05-16-04-08&quot;</span>
</span><span class='line'>    <span class="o">}</span>,
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;EventCategories&quot;</span>: <span class="o">[</span>
</span><span class='line'>            <span class="s2">&quot;creation&quot;</span>
</span><span class='line'>        <span class="o">]</span>,
</span><span class='line'>        <span class="s2">&quot;SourceType&quot;</span>: <span class="s2">&quot;db-snapshot&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;SourceArn&quot;</span>: <span class="s2">&quot;arn:aws:rds:eu-west-1:&lt;customer_id&gt;:snapshot:rds:db-2018-05-16-04-08&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;Date&quot;</span>: <span class="s2">&quot;2018-05-16T04:32:04.047Z&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;Message&quot;</span>: <span class="s2">&quot;Automated snapshot created&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;SourceIdentifier&quot;</span>: <span class="s2">&quot;rds:db-2018-05-16-04-08&quot;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>List Public RDS Instances:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod rds describe-db-instances --query <span class="s1">&#39;DBInstances[?PubliclyAccessible==`true`].[DBInstanceIdentifier,Endpoint.Address]&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span>
</span><span class='line'>  <span class="o">[</span>
</span><span class='line'>    <span class="s2">&quot;name&quot;</span>,
</span><span class='line'>    <span class="s2">&quot;name.abcdef.eu-west-1.rds.amazonaws.com&quot;</span>
</span><span class='line'>  <span class="o">]</span>
</span><span class='line'><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h2>SSM Parameter Store:</h2>

<p>List all parameters by path:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod ssm get-parameters-by-path --path <span class="s1">&#39;/service-a/team-a/my-app-name/&#39;</span> <span class="p">|</span> jq <span class="s1">&#39;.Parameters[]&#39;</span> <span class="p">|</span> jq -r <span class="s1">&#39;.Name&#39;</span>
</span><span class='line'>/service-a/team-a/my-app-name/db_hostname
</span><span class='line'>/service-a/team-a/my-app-name/db_username
</span><span class='line'>/service-a/team-a/my-app-name/db_password
</span></code></pre></td></tr></table></div></figure>


<p>Get a value from a parameter:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>aws --profile prod ssm get-parameters --names <span class="s1">&#39;/service-a/team-a/my-app-name/db_username&#39;</span> --with-decryption <span class="p">|</span> jq <span class="s1">&#39;.Parameters[]&#39;</span> <span class="p">|</span> jq -r <span class="s1">&#39;.Value&#39;</span>
</span><span class='line'>my_db_user
</span></code></pre></td></tr></table></div></figure>


<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/05/python-multiprocessing-tutorial/">Python Multiprocessing Tutorial</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-05T10:05:49-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>10:05 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I stumbled apon a great <a href="https://tutorialedge.net/python/python-multiprocessing-tutorial/">python multiprocessing tutorial</a>, when I was looking into spawning multiple processes in parallel on a Lambda function.</p>

<p>In this example im getting latencies between regions using tcpping, but instead of running them one at a time, I was looking into spawning them in parralel:</p>

<p>(code made static for demonstration)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">boto3</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">os</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">json</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="kn">as</span> <span class="nn">mp</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
</span><span class='line'>
</span><span class='line'><span class="n">region_maps</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="s">&#39;eu-west-1&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;dynamodb&#39;</span><span class="p">:</span> <span class="s">&#39;dynamodb.eu-west-1.amazonaws.com&#39;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="s">&#39;us-east-1&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;dynamodb&#39;</span><span class="p">:</span> <span class="s">&#39;dynamodb.us-east-1.amazonaws.com&#39;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="s">&#39;us-west-1&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;dynamodb&#39;</span><span class="p">:</span> <span class="s">&#39;dynamodb.us-west-1.amazonaws.com&#39;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="s">&#39;us-west-2&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;dynamodb&#39;</span><span class="p">:</span> <span class="s">&#39;dynamodb.us-west-2.amazonaws.com&#39;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="n">target_region</span><span class="p">,</span> <span class="n">target_service</span><span class="p">,</span> <span class="n">target_endpoint</span><span class="p">):</span>
</span><span class='line'>    <span class="n">static_results</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&quot;address&quot;</span><span class="p">:</span> <span class="n">target_endpoint</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;attempts&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;avg&quot;</span><span class="p">:</span> <span class="mf">481.80199999999996</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;max&quot;</span><span class="p">:</span> <span class="mf">816.25</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;min&quot;</span><span class="p">:</span> <span class="mf">312.46</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;port&quot;</span><span class="p">:</span> <span class="mi">443</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;region&quot;</span><span class="p">:</span> <span class="s">&quot;eu-west-1_{}_{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_service</span><span class="p">,</span> <span class="n">target_region</span><span class="p">),</span>
</span><span class='line'>        <span class="s">&quot;regionTo&quot;</span><span class="p">:</span> <span class="n">target_region</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;results&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="p">{</span><span class="s">&quot;seq&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">:</span> <span class="s">&quot;816.25&quot;</span><span class="p">},</span>
</span><span class='line'>            <span class="p">{</span><span class="s">&quot;seq&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">:</span> <span class="s">&quot;331.50&quot;</span><span class="p">},</span>
</span><span class='line'>            <span class="p">{</span><span class="s">&quot;seq&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">:</span> <span class="s">&quot;597.22&quot;</span><span class="p">},</span>
</span><span class='line'>            <span class="p">{</span><span class="s">&quot;seq&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">:</span> <span class="s">&quot;312.46&quot;</span><span class="p">},</span>
</span><span class='line'>            <span class="p">{</span><span class="s">&quot;seq&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">:</span> <span class="s">&quot;351.58&quot;</span><span class="p">}</span>
</span><span class='line'>        <span class="p">],</span>
</span><span class='line'>        <span class="s">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s">&quot;2019-02-05T17:10:32&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">static_results</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">dynamodb_write</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span class='line'>    <span class="n">ddb</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">profile_name</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s">&#39;eu-west-1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;dynamodb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="s">&#39;mydynamotable&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">ddb_parsed</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">parse_float</span><span class="o">=</span><span class="n">Decimal</span><span class="p">)</span>
</span><span class='line'>    <span class="n">response</span> <span class="o">=</span> <span class="n">ddb</span><span class="o">.</span><span class="n">put_item</span><span class="p">(</span><span class="n">Item</span><span class="o">=</span><span class="n">ddb_parsed</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">response</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">spawn_work</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
</span><span class='line'>    <span class="n">target_region</span> <span class="o">=</span> <span class="n">region</span>
</span><span class='line'>    <span class="n">target_service</span> <span class="o">=</span> <span class="s">&#39;dynamodb&#39;</span>
</span><span class='line'>    <span class="n">target_endpoint</span> <span class="o">=</span> <span class="n">region_maps</span><span class="p">[</span><span class="n">target_region</span><span class="p">][</span><span class="n">target_service</span><span class="p">]</span>
</span><span class='line'>    <span class="n">data</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">target_service</span><span class="p">,</span> <span class="n">target_endpoint</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;pid: {}, data: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="n">data</span><span class="p">))</span>
</span><span class='line'>    <span class="n">response</span> <span class="o">=</span> <span class="n">dynamodb_write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="n">pool</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">spawn_work</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;eu-west-1&#39;</span><span class="p">,</span> <span class="s">&#39;us-east-1&#39;</span><span class="p">,</span> <span class="s">&#39;us-west-1&#39;</span><span class="p">,</span> <span class="s">&#39;us-west-2&#39;</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>When running it locally, I can see that each job ran in its own pid:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>python foo.py
</span><span class='line'>pid: 31224, data: <span class="o">{</span><span class="s1">&#39;attempts&#39;</span>: 5, <span class="s1">&#39;min&#39;</span>: 312.46, <span class="s1">&#39;timestamp&#39;</span>: <span class="s1">&#39;2019-02-05T17:10:32&#39;</span>, <span class="s1">&#39;address&#39;</span>: <span class="s1">&#39;dynamodb.eu-west-1.amazonaws.com&#39;</span>, <span class="s1">&#39;max&#39;</span>: 816.25, <span class="s1">&#39;region&#39;</span>: <span class="s1">&#39;eu-west-1_dynamodb_eu-west-1&#39;</span>, <span class="s1">&#39;avg&#39;</span>: 481.80199999999996, <span class="s1">&#39;port&#39;</span>: 443, <span class="s1">&#39;regionTo&#39;</span>: <span class="s1">&#39;eu-west-1&#39;</span>, <span class="s1">&#39;results&#39;</span>: <span class="o">[{</span><span class="s1">&#39;seq&#39;</span>: 1, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;816.25&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 2, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;331.50&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 3, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;597.22&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 4, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;312.46&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 5, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;351.58&#39;</span><span class="o">}]}</span>
</span><span class='line'>
</span><span class='line'>pid: 31225, data: <span class="o">{</span><span class="s1">&#39;attempts&#39;</span>: 5, <span class="s1">&#39;min&#39;</span>: 312.46, <span class="s1">&#39;timestamp&#39;</span>: <span class="s1">&#39;2019-02-05T17:10:32&#39;</span>, <span class="s1">&#39;address&#39;</span>: <span class="s1">&#39;dynamodb.us-east-1.amazonaws.com&#39;</span>, <span class="s1">&#39;max&#39;</span>: 816.25, <span class="s1">&#39;region&#39;</span>: <span class="s1">&#39;eu-west-1_dynamodb_us-east-1&#39;</span>, <span class="s1">&#39;avg&#39;</span>: 481.80199999999996, <span class="s1">&#39;port&#39;</span>: 443, <span class="s1">&#39;regionTo&#39;</span>: <span class="s1">&#39;us-east-1&#39;</span>, <span class="s1">&#39;results&#39;</span>: <span class="o">[{</span><span class="s1">&#39;seq&#39;</span>: 1, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;816.25&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 2, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;331.50&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 3, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;597.22&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 4, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;312.46&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 5, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;351.58&#39;</span><span class="o">}]}</span>
</span><span class='line'>
</span><span class='line'>pid: 31226, data: <span class="o">{</span><span class="s1">&#39;attempts&#39;</span>: 5, <span class="s1">&#39;min&#39;</span>: 312.46, <span class="s1">&#39;timestamp&#39;</span>: <span class="s1">&#39;2019-02-05T17:10:32&#39;</span>, <span class="s1">&#39;address&#39;</span>: <span class="s1">&#39;dynamodb.us-west-1.amazonaws.com&#39;</span>, <span class="s1">&#39;max&#39;</span>: 816.25, <span class="s1">&#39;region&#39;</span>: <span class="s1">&#39;eu-west-1_dynamodb_us-west-1&#39;</span>, <span class="s1">&#39;avg&#39;</span>: 481.80199999999996, <span class="s1">&#39;port&#39;</span>: 443, <span class="s1">&#39;regionTo&#39;</span>: <span class="s1">&#39;us-west-1&#39;</span>, <span class="s1">&#39;results&#39;</span>: <span class="o">[{</span><span class="s1">&#39;seq&#39;</span>: 1, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;816.25&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 2, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;331.50&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 3, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;597.22&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 4, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;312.46&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 5, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;351.58&#39;</span><span class="o">}]}</span>
</span><span class='line'>
</span><span class='line'>pid: 31227, data: <span class="o">{</span><span class="s1">&#39;attempts&#39;</span>: 5, <span class="s1">&#39;min&#39;</span>: 312.46, <span class="s1">&#39;timestamp&#39;</span>: <span class="s1">&#39;2019-02-05T17:10:32&#39;</span>, <span class="s1">&#39;address&#39;</span>: <span class="s1">&#39;dynamodb.us-west-2.amazonaws.com&#39;</span>, <span class="s1">&#39;max&#39;</span>: 816.25, <span class="s1">&#39;region&#39;</span>: <span class="s1">&#39;eu-west-1_dynamodb_us-west-2&#39;</span>, <span class="s1">&#39;avg&#39;</span>: 481.80199999999996, <span class="s1">&#39;port&#39;</span>: 443, <span class="s1">&#39;regionTo&#39;</span>: <span class="s1">&#39;us-west-2&#39;</span>, <span class="s1">&#39;results&#39;</span>: <span class="o">[{</span><span class="s1">&#39;seq&#39;</span>: 1, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;816.25&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 2, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;331.50&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 3, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;597.22&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 4, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;312.46&#39;</span><span class="o">}</span>, <span class="o">{</span><span class="s1">&#39;seq&#39;</span>: 5, <span class="s1">&#39;time&#39;</span>: <span class="s1">&#39;351.58&#39;</span><span class="o">}]}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Quite useful! Have a look at the link shared for more examples.</p>

<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/02/05/convert-float-to-decimal-data-types-for-boto3-dynamodb-using-python/">Convert Float to Decimal Data Types for Boto3 DynamoDB Using Python</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-02-05T09:45:40-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>9:45 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A quick post on a workaround when you need to convert float to decimal types.</p>

<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>


<p>One thing I really don&rsquo;t like about the AWS SDK for Python, specifically aimed towards DynamoDB is that Float types are not supported and that you should use Decimal types instead.</p>

<p>For example, my payload below:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span>
</span><span class='line'><span class="p">{</span><span class="s">&#39;attempts&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;min&#39;</span><span class="p">:</span> <span class="mf">180.87</span><span class="p">,</span> <span class="s">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s">&#39;2019-02-05T15:48:27&#39;</span><span class="p">,</span> <span class="s">&#39;address&#39;</span><span class="p">:</span> <span class="s">&#39;dynamodb.us-east-1.amazonaws.com&#39;</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span> <span class="mf">747.17</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">:</span> <span class="s">&#39;eu-west-1_dynamodb&#39;</span><span class="p">,</span> <span class="s">&#39;avg&#39;</span><span class="p">:</span> <span class="mf">311.32599999999996</span><span class="p">,</span> <span class="s">&#39;port&#39;</span><span class="p">:</span> <span class="mi">443</span><span class="p">,</span> <span class="s">&#39;regionTo&#39;</span><span class="p">:</span> <span class="s">&#39;us-east-1&#39;</span><span class="p">,</span> <span class="s">&#39;results&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">&#39;seq&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;time&#39;</span><span class="p">:</span> <span class="s">&#39;747.17&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;seq&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;time&#39;</span><span class="p">:</span> <span class="s">&#39;215.60&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;seq&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;time&#39;</span><span class="p">:</span> <span class="s">&#39;230.67&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;seq&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;time&#39;</span><span class="p">:</span> <span class="s">&#39;180.87&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;seq&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;time&#39;</span><span class="p">:</span> <span class="s">&#39;182.32&#39;</span><span class="p">}]}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Trying to write that as an Item to my DynamoDB table and you will be faced with the exception below:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">ddb</span><span class="o">.</span><span class="n">put_item</span><span class="p">(</span><span class="n">Item</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'><span class="ne">TypeError</span><span class="p">:</span> <span class="n">Float</span> <span class="n">types</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">supported</span><span class="o">.</span> <span class="n">Use</span> <span class="n">Decimal</span> <span class="n">types</span> <span class="n">instead</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>One way around this is to use <code>parse_float</code> in <code>json.loads()</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">json</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">ddb_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">parse_float</span><span class="o">=</span><span class="n">Decimal</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">ddb_data</span>
</span><span class='line'><span class="p">{</span><span class="s">u&#39;max&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;747.17&#39;</span><span class="p">),</span> <span class="s">u&#39;min&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;180.87&#39;</span><span class="p">),</span> <span class="s">u&#39;timestamp&#39;</span><span class="p">:</span> <span class="s">u&#39;2019-02-05T15:48:27&#39;</span><span class="p">,</span> <span class="s">u&#39;region&#39;</span><span class="p">:</span> <span class="s">u&#39;eu-west-1_dynamodb&#39;</span><span class="p">,</span> <span class="s">u&#39;regionTo&#39;</span><span class="p">:</span> <span class="s">u&#39;us-east-1&#39;</span><span class="p">,</span> <span class="s">u&#39;results&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">u&#39;seq&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">u&#39;time&#39;</span><span class="p">:</span> <span class="s">u&#39;747.17&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">u&#39;seq&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">u&#39;time&#39;</span><span class="p">:</span> <span class="s">u&#39;215.60&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">u&#39;seq&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">u&#39;time&#39;</span><span class="p">:</span> <span class="s">u&#39;230.67&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">u&#39;seq&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">u&#39;time&#39;</span><span class="p">:</span> <span class="s">u&#39;180.87&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">u&#39;seq&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">u&#39;time&#39;</span><span class="p">:</span> <span class="s">u&#39;182.32&#39;</span><span class="p">}],</span> <span class="s">u&#39;attempts&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">u&#39;address&#39;</span><span class="p">:</span> <span class="s">u&#39;dynamodb.us-east-1.amazonaws.com&#39;</span><span class="p">,</span> <span class="s">u&#39;avg&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s">&#39;311.32599999999996&#39;</span><span class="p">),</span> <span class="s">u&#39;port&#39;</span><span class="p">:</span> <span class="mi">443</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/01/29/paginate-through-iam-users-on-aws-using-python-and-boto3/">Paginate Through IAM Users on AWS Using Python and Boto3</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-01-29T10:03:24-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>10:03 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When listing AWS IAM Users in Boto3, you will find that not all the users are retrieved. This is because they are paginated.</p>

<p>To do a normal list_users api call:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">boto3</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">iam</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="s">&#39;eu-west-1&#39;</span><span class="p">,</span> <span class="n">profile_name</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s">&#39;iam&#39;</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">iam</span><span class="o">.</span><span class="n">list_users</span><span class="p">()[</span><span class="s">&#39;Users&#39;</span><span class="p">])</span>
</span><span class='line'><span class="mi">100</span>
</span></code></pre></td></tr></table></div></figure>


<p>Although I know there&rsquo;s more than 200 users. Therefore we need to paginate through our users:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">boto3</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">iam</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="s">&#39;eu-west-1&#39;</span><span class="p">,</span> <span class="n">profile_name</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s">&#39;iam&#39;</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">paginator</span> <span class="o">=</span> <span class="n">iam</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s">&#39;list_users&#39;</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">users</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">all_users</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">():</span>
</span><span class='line'><span class="o">...</span>     <span class="n">users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s">&#39;Users&#39;</span><span class="p">])</span>
</span><span class='line'><span class="o">...</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">users</span><span class="p">)</span>
</span><span class='line'><span class="mi">3</span>
</span><span class='line'>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">users</span><span class="p">)):</span>
</span><span class='line'><span class="o">...</span>     <span class="k">for</span> <span class="n">userobj</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="n">iteration</span><span class="p">])):</span>
</span><span class='line'><span class="o">...</span>         <span class="n">all_users</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">users</span><span class="p">[</span><span class="n">iteration</span><span class="p">][</span><span class="n">userobj</span><span class="p">][</span><span class="s">&#39;UserName&#39;</span><span class="p">]))</span>
</span><span class='line'><span class="o">...</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_users</span><span class="p">)</span>
</span><span class='line'><span class="mi">210</span>
</span></code></pre></td></tr></table></div></figure>


<p>For more information on this, have a look at AWS Documentation about <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/paginators.html">Pagination</a></p>

<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
<img alt="" border="0" src="https://www.paypal.com/en_ZA/i/scr/pixel.gif" width="1" height="1" />
</form>
</center>


<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2019/01/10/setup-a-3-node-docker-swarm-cluster-on-ubuntu-16-dot-04/">Setup a 3 Node Docker Swarm Cluster on Ubuntu 16.04</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2019-01-10T09:52:07-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2019</span></span> <span class='time'>9:52 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="https://user-images.githubusercontent.com/567298/53351889-85572000-392a-11e9-9720-464e9318206e.jpg" alt="" /></p>

<p>Docker Swarm is a Clustering and Orchestration Framework for the Docker ecosystem. Have a look at their <a href="https://docs.docker.com/engine/swarm/">official documentation</a> for detailed information.</p>

<p>In this Tutorial we will Setup a 3 Node Docker Swarm Cluster and to Demonstrate How Easy it is to Deploy a Web Application with 2 Replicas from a Docker Image.</p>

<p><br></p>

<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"rbekker87","width":728,"height":90,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>


<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>


<p><br></p>

<h2>Overview of What we will be Doing</h2>

<ul>
<li>Install Docker on 3 Servers with Ubuntu 16.04</li>
<li>Initialize the Swarm and Join the Worker Nodes</li>
<li>Create a Nginx Service with 2 Replicas</li>
<li>Do some Inspection: View some info on the Service</li>
</ul>


<h2>Prerequisites</h2>

<p>3 Fresh Deployed Ubuntu 16.04 Servers. ( 1GB Memory Servers will be good for development )</p>

<h2>What is Docker</h2>

<p>Docker is a Open Source Technology that allows you to create lightweight, isolated, reproducible application instances which is called Containers. Docker is built on top of the LXC technology, so it uses Linux Containers and as mentioned, it&rsquo;s lightweight compared to a traditional VM.</p>

<p>A Container is isolated and uses the Kernel of the Docker host, it also utilizes Kernel features such as cgroups and namespaces in order to make them isolated.</p>

<h2>Installing Docker Community Edition</h2>

<p>Remove any older versions of Docker that might be present and install the dependencies:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt remove docker docker-engine -y
</span><span class='line'><span class="nv">$ </span>sudo apt install linux-image-extra-<span class="k">$(</span>uname -r<span class="k">)</span> linux-image-extra-virtual python-setuptools -y
</span><span class='line'><span class="nv">$ </span>sudo apt install apt-transport-https ca-certificates curl software-properties-common -y
</span></code></pre></td></tr></table></div></figure>


<p>Get the needed repository to setup Docker Community Edition:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="p">|</span> sudo apt-key add -
</span><span class='line'><span class="nv">$ </span>sudo apt-key fingerprint 0EBFCD88
</span><span class='line'><span class="nv">$ </span>sudo add-apt-repository <span class="s2">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Update the repository index and Install Docker Community Edition:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt update
</span><span class='line'><span class="nv">$ </span>sudo apt install docker-ce -y
</span><span class='line'><span class="nv">$ </span>sudo easy_install pip
</span><span class='line'><span class="nv">$ </span>sudo pip install docker-compose
</span></code></pre></td></tr></table></div></figure>


<p>Enable Docker on Startup and Start the Docker Engine:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo systemctl <span class="nb">enable </span>docker
</span><span class='line'><span class="nv">$ </span>sudo systemctl restart docker
</span></code></pre></td></tr></table></div></figure>


<p>If you would like to execute your docker commands without sudo, add your user to the docker group:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo usermod -aG docker <span class="k">$(</span>whoami<span class="k">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Test your Setup by Running a Hello World Container. You will see that if the image is not in the local docker image cache, it will pull the image from docker hub (or the respective docker registry), then once the image is saved locally, docker will then instantiate the container from that image:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>docker run hello-world
</span><span class='line'>Unable to find image <span class="s1">&#39;hello-world:latest&#39;</span> locally
</span><span class='line'>latest: Pulling from library/hello-world
</span><span class='line'>78445dd45222: Pull <span class="nb">complete</span>
</span><span class='line'>Digest: sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7
</span><span class='line'>Status: Downloaded newer image <span class="k">for</span> hello-world:latest
</span><span class='line'>
</span><span class='line'>Hello from Docker!
</span><span class='line'>This message shows that your installation appears to be working correctly.
</span></code></pre></td></tr></table></div></figure>


<h2>DNS Configuration</h2>

<p>If you have a DNS Server you can configure the A Records for these hosts on DNS, but for simplicity, I will add the noted IP Addresses from the previous step into my <code>/etc/hosts</code> file so we can resolve names to IP&rsquo;s</p>

<p>Open up the the hosts file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo vim /etc/hosts
</span></code></pre></td></tr></table></div></figure>


<p>In my example, my IP Addresses:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>192.0.2.41  manager
</span><span class='line'>192.0.2.42  worker-1
</span><span class='line'>192.0.2.43  worker-2
</span></code></pre></td></tr></table></div></figure>


<p>Repeat the above steps on the other 2 Servers and make note of the IP Addresses of each node. You should be able to ping and reach the nodes that was configured. Make sure to allow all traffic between these nodes.</p>

<h2>Initialize the Swarm:</h2>

<p>Now we will initialize the swarm on the manager node and as we have more than one network interface, we will specify the &ndash;advertise-addr option:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>docker swarm init --advertise-addr 192.0.2.41
</span><span class='line'>Swarm initialized: current node <span class="o">(</span>siqyf3yricsvjkzvej00a9b8h<span class="o">)</span> is now a manager.
</span><span class='line'>
</span><span class='line'>    To add a worker to this swarm, run the following <span class="nb">command</span>:
</span><span class='line'>
</span><span class='line'>    docker swarm join <span class="se">\</span>
</span><span class='line'>    --token SWMTKN-1-0eith07xkcg93lzftuhjmxaxwfa6mbkjsmjzb3d3sx9cobc2zp-97s6xzdt27y2gk3kpm0cgo6y2 <span class="se">\</span>
</span><span class='line'>    192.0.2.41:2377
</span><span class='line'>
</span><span class='line'>    To add a manager to this swarm, run <span class="s1">&#39;docker swarm join-token manager&#39;</span> and follow the instructions.
</span></code></pre></td></tr></table></div></figure>


<p>From the response above, we received the join token that allows the workers to register with the manager node. If its a scenario where you want to have more than one manager node, you can run <code>docker swarm join-token manager</code> to receive the join token for additional manager.</p>

<p>Let&rsquo;s add the two worker nodes to the manager:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="o">[</span>worker-1<span class="o">]</span> docker swarm join --token SWMTKN-1-0eith07xkcg93lzftuhjmxaxwfa6mbkjsmjzb3d3sx9cobc2zp-97s6xzdt27y2gk3kpm0cgo6y2 192.0.2.41:2377
</span><span class='line'>This node joined a swarm as a worker.
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="o">[</span>worker-2<span class="o">]</span> docker swarm join --token SWMTKN-1-0eith07xkcg93lzftuhjmxaxwfa6mbkjsmjzb3d3sx9cobc2zp-97s6xzdt27y2gk3kpm0cgo6y2 192.0.2.41:2377
</span><span class='line'>This node joined a swarm as a worker.
</span></code></pre></td></tr></table></div></figure>


<p>To see the node status, so that we can determine if the nodes are active/available etc, from the manager node, list all the nodes in the swarm:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker node ls
</span><span class='line'>ID                           HOSTNAME  STATUS  AVAILABILITY  MANAGER STATUS
</span><span class='line'>j14mte3v1jhtbm3pb2qrpgwp6    worker-1  Ready   Active
</span><span class='line'>siqyf3yricsvjkzvej00a9b8h *  master    Ready   Active        Leader
</span><span class='line'>srl5yzme5hxnzxal2t1efmwje    worker-2  Ready   Active
</span></code></pre></td></tr></table></div></figure>


<h2>Reobtaining the Join Tokens</h2>

<p>If at any time, you lost your join token, it can be retrieved by running the following for the manager token:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>docker swarm join-token manager -q SWMTKN-1-67chzvi4epx28ii18gizcia8idfar5hokojz660igeavnrltf0-09ijujbnnh4v960b8xel58pmj
</span></code></pre></td></tr></table></div></figure>


<p>And the following to retrieve the worker token:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>docker swarm join-token worker -q SWMTKN-1-67chzvi4epx28ii18gizcia8idfar5hokojz660igeavnrltf0-acs21nn28v17uwhw0oqg5ibwx
</span></code></pre></td></tr></table></div></figure>


<p>Swarm Services in Docker uses a declarative model which means that you define the desired state of the service, and rely on Docker to maintain this state. More information on this can be found on their <a href="https://docs.docker.com/engine/swarm/how-swarm-mode-works/services/">Documentation</a></p>

<p>At this moment, we will see that we have no services running in our swarm:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker service ls
</span><span class='line'>ID  NAME  MODE  REPLICAS  IMAGE
</span></code></pre></td></tr></table></div></figure>


<h2>Deploying our First Service</h2>

<p>Now onto the creation of a standard nginx service with 2 replicas, which means that there will be 2 containers of nginx running in our swarm.</p>

<p>But first, we need to create a overlay network, which is a network driver that creates a distributed network among multiple Docker daemon hosts. Swarm takes care of the routing automatically, which is routed via the port mappings. So you can have that your container sits on worker-2, when you hit your manager node on the published port, it will route the request to the desired application that resides on the respective container.</p>

<p>To create a overlay network called mynet:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker network create --driver overlay mynet
</span></code></pre></td></tr></table></div></figure>


<p>Now onto creating the Service. If any of these containers fail, they will handled by the manager node and will be spawned again to have the desired number that we set on the replica option:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker service create --name my-web --publish 8080:80 --replicas <span class="m">2</span> --network mynet nginx
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s have a look at our nginx service:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker service ls
</span><span class='line'>ID            NAME    MODE        REPLICAS  IMAGE
</span><span class='line'>1okycpshfusq  my-web  replicated  2/2       nginx:latest
</span></code></pre></td></tr></table></div></figure>


<p>After we see that the replica count is 2/2 our service is ready.</p>

<p>To see on which nodes our containers are running that makes up our service:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker service ps my-web
</span><span class='line'>ID            NAME      IMAGE         NODE      DESIRED STATE  CURRENT STATE           ERROR  PORTS
</span><span class='line'>k0qqrh8s0c2d  my-web.1  nginx:latest  worker-1  Running        Running <span class="m">30</span> seconds ago
</span><span class='line'>nku9wer6tmll  my-web.2  nginx:latest  worker-2  Running        Running <span class="m">30</span> seconds ago
</span></code></pre></td></tr></table></div></figure>


<p>From the above output, we can see that worker-1 and worker-2 are serving our containers for our service. We can also retrieve more information of our service by using the inspect option, which will give you a detailed response in json format of the service:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker service inspect my-web
</span></code></pre></td></tr></table></div></figure>


<p>We can get the Endpoint Port info by using inspect and using the &ndash;format parameter to filter the output:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>manager<span class="o">]</span> <span class="nv">$ </span>docker service inspect --format<span class="o">=</span><span class="s2">&quot;&quot;</span> my-web  <span class="p">|</span> python -m json.tool
</span></code></pre></td></tr></table></div></figure>


<p>From the output we will find the PublishedPort is the Port that we Expose, which will be the listener. Our TargetPort will be the port that is listening on the container:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nt">&quot;Protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;PublishMode&quot;</span><span class="p">:</span> <span class="s2">&quot;ingress&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;PublishedPort&quot;</span><span class="p">:</span> <span class="mi">8080</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;TargetPort&quot;</span><span class="p">:</span> <span class="mi">80</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that we went through the inspection of our service, its time to test our base nginx service.</p>

<h2>Testing Nginx in our Swarm</h2>

<p>Make a request against your docker node manager address on the port that was exposed, in this case 8080:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -I http://docker-node-manager-ip:8080
</span><span class='line'>
</span><span class='line'>HTTP/1.1 <span class="m">200</span> OK
</span><span class='line'>Server: nginx/1.15.5
</span><span class='line'>Date: Thu, <span class="m">10</span> Jan <span class="m">2019</span> 14:48:40 GMT
</span><span class='line'>Content-Type: text/html
</span><span class='line'>Content-Length: 612
</span><span class='line'>Last-Modified: Tue, <span class="m">02</span> Oct <span class="m">2018</span> 14:49:27 GMT
</span><span class='line'>Connection: keep-alive
</span><span class='line'>ETag: <span class="s2">&quot;5bb38577-264&quot;</span>
</span><span class='line'>Accept-Ranges: bytes
</span></code></pre></td></tr></table></div></figure>


<p>Now we have successfull setup a 3 node docker swarm cluster and deployed a basic nginx service to our swarm. Please have a look at my other <a href="https://blog.ruanbekker.com/blog/categories/docker/">Docker Swarm Tutorials</a> for other content.</p>

<h2>Thank You</h2>

<p>Please feel free to show support by, <strong>sharing</strong> this post, making a <strong>donation</strong>, <strong>subscribing</strong> or <strong>reach out to me</strong> if you want me to demo and write up on any specific tech topic.</p>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick" />
<input type="hidden" name="hosted_button_id" value="W7CBGYTCWGANQ" />
<input type="image" src="https://user-images.githubusercontent.com/567298/49853901-461c3700-fdf1-11e8-9d80-8a424a3173af.png" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
</form>
</center>




<p><p></p>

<p>Thanks for reading!</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/index.html">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Subscribe</h1>
  <!-- Begin MailChimp Signup Form -->
  <div id="mc_embed_signup">
  <form action="https://sysadmins.us15.list-manage.com/subscribe/post?u=3dfcff447b6ee598231eeb658&amp;id=3542f323a9" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
      <div class="indicates-required"><span class="asterisk"></span></div>
      <div class="mc-field-group">
	<label for="mce-EMAIL">Email Address:  <span class="asterisk"></span>
        </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
        </div>
	<div id="mce-responses" class="clear">
	  <div class="response" id="mce-error-response" style="display:none"></div>
	  <div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3dfcff447b6ee598231eeb658_3542f323a9" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
  </form>
</div>
<!--End mc_embed_signup-->
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/03/05/setup-a-3-node-replicated-storage-volume-with-glusterfs/">Setup a 3 Node Replicated Storage Volume With GlusterFS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/03/05/container-persistent-storage-for-docker-swarm-using-a-glusterfs-volume-plugin/">Container Persistent Storage for Docker Swarm Using a GlusterFS Volume PLugin</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/03/04/setup-a-distributed-storage-volume-with-glusterfs/">Setup a Distributed Storage Volume With GlusterFS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/02/28/use-swarm-managed-configs-in-docker-swarm-to-store-your-application-configs/">Use Swarm Managed Configs in Docker Swarm to Store Your Application Configs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/02/27/how-to-validate-strings-in-python-with-regex/">How to Validate Strings in Python With Regex</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2019 - Ruan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>



  <li>
    <a href="https://twitter.com/ruanbekker">
      <i class="fa fa-twitter"></i> Twitter
    </a>
  </li>



  <li>
    <a href="https://github.com/ruanbekker">
      <i class="fa fa-github"></i> GitHub
    </a>
  </li>



  <li>
    <a href="https://sysadmins.co.za">
      <i class="fa fa-bars"></i> My HowTo Blog
    </a>
  </li>


</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'blog-ruanbekker';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
